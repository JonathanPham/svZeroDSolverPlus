\hypertarget{configreader_8hpp_source}{}\doxysection{configreader.\+hpp}
\label{configreader_8hpp_source}\index{io/configreader.hpp@{io/configreader.hpp}}
\mbox{\hyperlink{configreader_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/**}}
\DoxyCodeLine{2 \textcolor{comment}{ * @file configreader.hpp}}
\DoxyCodeLine{3 \textcolor{comment}{ * @brief IO::ConfigReader source file}}
\DoxyCodeLine{4 \textcolor{comment}{ */}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{10 }
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include "{}../model/model.hpp"{}}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}../model/junction.hpp"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../helpers/debug.hpp"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}simdjson.h"{}}}
\DoxyCodeLine{15 }
\DoxyCodeLine{16 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_i_o}{IO}}}
\DoxyCodeLine{17 \{}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{    /**}}
\DoxyCodeLine{20 \textcolor{comment}{     * @brief svZeroDSolver configuration reader.}}
\DoxyCodeLine{21 \textcolor{comment}{     *}}
\DoxyCodeLine{22 \textcolor{comment}{     * @tparam T Scalar type (e.g. `float`, `double`)}}
\DoxyCodeLine{23 \textcolor{comment}{     */}}
\DoxyCodeLine{24     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{25     \textcolor{keyword}{class }\mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader}}}
\DoxyCodeLine{26     \{}
\DoxyCodeLine{27     \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{28 \textcolor{comment}{        /**}}
\DoxyCodeLine{29 \textcolor{comment}{         * @brief Construct a new Config Reader object}}
\DoxyCodeLine{30 \textcolor{comment}{         */}}
\DoxyCodeLine{31         \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}();}
\DoxyCodeLine{32 \textcolor{comment}{}}
\DoxyCodeLine{33 \textcolor{comment}{        /**}}
\DoxyCodeLine{34 \textcolor{comment}{         * @brief Construct a new Config Reader object}}
\DoxyCodeLine{35 \textcolor{comment}{         *}}
\DoxyCodeLine{36 \textcolor{comment}{         * @param filename Name of the configuration file}}
\DoxyCodeLine{37 \textcolor{comment}{         */}}
\DoxyCodeLine{38         \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}(std::string filename);}
\DoxyCodeLine{39 \textcolor{comment}{}}
\DoxyCodeLine{40 \textcolor{comment}{        /**}}
\DoxyCodeLine{41 \textcolor{comment}{         * @brief Destroy the Config Reader object}}
\DoxyCodeLine{42 \textcolor{comment}{         */}}
\DoxyCodeLine{43         \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{\string~ConfigReader}}();}
\DoxyCodeLine{44 \textcolor{comment}{}}
\DoxyCodeLine{45 \textcolor{comment}{        /**}}
\DoxyCodeLine{46 \textcolor{comment}{         * @brief Create model from configuration file}}
\DoxyCodeLine{47 \textcolor{comment}{         *}}
\DoxyCodeLine{48 \textcolor{comment}{         * @return Model}}
\DoxyCodeLine{49 \textcolor{comment}{         */}}
\DoxyCodeLine{50         \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{get\_model}}();}
\DoxyCodeLine{51 \textcolor{comment}{}}
\DoxyCodeLine{52 \textcolor{comment}{        /**}}
\DoxyCodeLine{53 \textcolor{comment}{         * @brief Get number of time steps based on configuration}}
\DoxyCodeLine{54 \textcolor{comment}{         *}}
\DoxyCodeLine{55 \textcolor{comment}{         * @return Number of time steps}}
\DoxyCodeLine{56 \textcolor{comment}{         */}}
\DoxyCodeLine{57         \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a30a6649ef956d00d48eb14118d7f4bf4}{get\_num\_time\_steps}}();}
\DoxyCodeLine{58 \textcolor{comment}{}}
\DoxyCodeLine{59 \textcolor{comment}{        /**}}
\DoxyCodeLine{60 \textcolor{comment}{         * @brief Get the time step size based on configuration}}
\DoxyCodeLine{61 \textcolor{comment}{         *}}
\DoxyCodeLine{62 \textcolor{comment}{         * @return Time step size}}
\DoxyCodeLine{63 \textcolor{comment}{         */}}
\DoxyCodeLine{64         T \mbox{\hyperlink{class_i_o_1_1_config_reader_ae63fc5536e55937512435528dcd262bc}{get\_time\_step\_size}}();}
\DoxyCodeLine{65 }
\DoxyCodeLine{66         T \mbox{\hyperlink{class_i_o_1_1_config_reader_a7401fb68b296447b8152636d1d363416}{cardiac\_cycle\_period}} = 1.0; \textcolor{comment}{///< Cardiac cycle period}}
\DoxyCodeLine{67 }
\DoxyCodeLine{68     \textcolor{keyword}{private}:}
\DoxyCodeLine{69         \textcolor{keywordtype}{bool} model\_created = \textcolor{keyword}{false};}
\DoxyCodeLine{70         simdjson::dom::parser parser;}
\DoxyCodeLine{71         simdjson::dom::element config;}
\DoxyCodeLine{72         \textcolor{keyword}{static} \textcolor{keywordtype}{bool} has\_key(simdjson::dom::element \&ele, std::string key);}
\DoxyCodeLine{73         \textcolor{keyword}{static} T get\_default(simdjson::dom::element \&ele, std::string key, T def);}
\DoxyCodeLine{74         \textcolor{keyword}{static} simdjson::dom::element get\_default(simdjson::dom::element \&ele, std::string key, simdjson::dom::element def);}
\DoxyCodeLine{75         \textcolor{keyword}{static} \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} get\_time\_dependent\_parameter(simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values);}
\DoxyCodeLine{76     \};}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{79     \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader<T>::ConfigReader}}(std::string filename)}
\DoxyCodeLine{80     \{}
\DoxyCodeLine{81         config = parser.load(filename);}
\DoxyCodeLine{82     \}}
\DoxyCodeLine{83 }
\DoxyCodeLine{84     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{85     \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{ConfigReader<T>::\string~ConfigReader}}()}
\DoxyCodeLine{86     \{}
\DoxyCodeLine{87     \}}
\DoxyCodeLine{88 }
\DoxyCodeLine{89     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{90     \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::has\_key}}(simdjson::dom::element \&ele, std::string key)}
\DoxyCodeLine{91     \{}
\DoxyCodeLine{92         \textcolor{keywordtype}{bool} has\_key = \textcolor{keyword}{true};}
\DoxyCodeLine{93         \textcolor{keywordflow}{try}}
\DoxyCodeLine{94         \{}
\DoxyCodeLine{95             simdjson::dom::element tmp = ele.at\_key(key);}
\DoxyCodeLine{96         \}}
\DoxyCodeLine{97         \textcolor{keywordflow}{catch} (simdjson::simdjson\_error)}
\DoxyCodeLine{98         \{}
\DoxyCodeLine{99             has\_key = \textcolor{keyword}{false};}
\DoxyCodeLine{100         \}}
\DoxyCodeLine{101         \textcolor{keywordflow}{return} has\_key;}
\DoxyCodeLine{102     \}}
\DoxyCodeLine{103 }
\DoxyCodeLine{104     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{105     T ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key, T def)}
\DoxyCodeLine{106     \{}
\DoxyCodeLine{107         T value = def;}
\DoxyCodeLine{108         \textcolor{keywordflow}{if} (has\_key(ele, key))}
\DoxyCodeLine{109         \{}
\DoxyCodeLine{110             value = ele[key];}
\DoxyCodeLine{111         \}}
\DoxyCodeLine{112         \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{113     \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{116     simdjson::dom::element ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key, simdjson::dom::element def)}
\DoxyCodeLine{117     \{}
\DoxyCodeLine{118         simdjson::dom::element value = def;}
\DoxyCodeLine{119         \textcolor{keywordflow}{if} (has\_key(ele, key))}
\DoxyCodeLine{120         \{}
\DoxyCodeLine{121             value = ele[key];}
\DoxyCodeLine{122         \}}
\DoxyCodeLine{123         \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{124     \}}
\DoxyCodeLine{125 }
\DoxyCodeLine{126     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{127     \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} ConfigReader<T>::get\_time\_dependent\_parameter(simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values)}
\DoxyCodeLine{128     \{}
\DoxyCodeLine{129         std::vector<T> times;}
\DoxyCodeLine{130         std::vector<T> values;}
\DoxyCodeLine{131         \textcolor{keywordflow}{if} (json\_values.is\_double())}
\DoxyCodeLine{132         \{}
\DoxyCodeLine{133             values.push\_back(json\_values);}
\DoxyCodeLine{134         \}}
\DoxyCodeLine{135         \textcolor{keywordflow}{else}}
\DoxyCodeLine{136         \{}
\DoxyCodeLine{137             \textcolor{keywordtype}{int} len = simdjson::dom::array(json\_times).size();}
\DoxyCodeLine{138             times.reserve(len);}
\DoxyCodeLine{139             values.reserve(len);}
\DoxyCodeLine{140             \textcolor{keywordflow}{for} (T time : json\_times)}
\DoxyCodeLine{141             \{}
\DoxyCodeLine{142                 times.push\_back(time);}
\DoxyCodeLine{143             \}}
\DoxyCodeLine{144             \textcolor{keywordflow}{for} (T value : json\_values)}
\DoxyCodeLine{145             \{}
\DoxyCodeLine{146                 values.push\_back(value);}
\DoxyCodeLine{147             \}}
\DoxyCodeLine{148         \}}
\DoxyCodeLine{149         \textcolor{keywordflow}{return} \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}}(times, values);}
\DoxyCodeLine{150     \}}
\DoxyCodeLine{151 }
\DoxyCodeLine{152     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{153     \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{ConfigReader<T>::get\_model}}()}
\DoxyCodeLine{154     \{}
\DoxyCodeLine{155         \textcolor{comment}{// Create blog mapping}}
\DoxyCodeLine{156         \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} model;}
\DoxyCodeLine{157 }
\DoxyCodeLine{158         \textcolor{comment}{// Create list to store block connections while generating blocks}}
\DoxyCodeLine{159         std::vector<std::tuple<std::string, std::string>> connections;}
\DoxyCodeLine{160 }
\DoxyCodeLine{161         \textcolor{comment}{// Create junctions}}
\DoxyCodeLine{162         \textcolor{keywordflow}{for} (simdjson::dom::element junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}])}
\DoxyCodeLine{163         \{}
\DoxyCodeLine{164             \textcolor{keywordflow}{if} ((\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) == \textcolor{stringliteral}{"{}NORMAL\_JUNCTION"{}}) || (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) == \textcolor{stringliteral}{"{}internal\_junction"{}}))}
\DoxyCodeLine{165             \{}
\DoxyCodeLine{166                 std::string name = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_name"{}}]);}
\DoxyCodeLine{167                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(name)));}
\DoxyCodeLine{168                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created junction "{}} << name);}
\DoxyCodeLine{169                 \textcolor{keywordflow}{for} (simdjson::dom::element inlet\_vessel : junction\_config[\textcolor{stringliteral}{"{}inlet\_vessels"{}}])}
\DoxyCodeLine{170                 \{}
\DoxyCodeLine{171                     \textcolor{keyword}{auto} connection = std::make\_tuple(\textcolor{stringliteral}{"{}V"{}} + std::to\_string(inlet\_vessel.get\_int64()), name);}
\DoxyCodeLine{172                     connections.push\_back(connection);}
\DoxyCodeLine{173                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Found connection "{}} << std::get<0>(connection) << \textcolor{stringliteral}{"{}/"{}} << std::get<1>(connection));}
\DoxyCodeLine{174                 \}}
\DoxyCodeLine{175                 \textcolor{keywordflow}{for} (simdjson::dom::element outlet\_vessel : junction\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}])}
\DoxyCodeLine{176                 \{}
\DoxyCodeLine{177                     \textcolor{keyword}{auto} connection = std::make\_tuple(name, \textcolor{stringliteral}{"{}V"{}} + std::to\_string(outlet\_vessel.get\_int64()));}
\DoxyCodeLine{178                     connections.push\_back(connection);}
\DoxyCodeLine{179                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Found connection "{}} << std::get<0>(connection) << \textcolor{stringliteral}{"{}/"{}} << std::get<1>(connection));}
\DoxyCodeLine{180                 \}}
\DoxyCodeLine{181             \}}
\DoxyCodeLine{182             \textcolor{keywordflow}{else}}
\DoxyCodeLine{183             \{}
\DoxyCodeLine{184                 \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown junction type "{}} + \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]));}
\DoxyCodeLine{185             \}}
\DoxyCodeLine{186         \}}
\DoxyCodeLine{187 }
\DoxyCodeLine{188         \textcolor{comment}{// Create vessels}}
\DoxyCodeLine{189         \textcolor{keywordflow}{for} (simdjson::dom::element vessel\_config : config[\textcolor{stringliteral}{"{}vessels"{}}])}
\DoxyCodeLine{190         \{}
\DoxyCodeLine{191             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_type"{}}]) == \textcolor{stringliteral}{"{}BloodVessel"{}})}
\DoxyCodeLine{192             \{}
\DoxyCodeLine{193                 simdjson::dom::element vessel\_values = vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_values"{}}];}
\DoxyCodeLine{194                 std::string vessel\_id\_string = std::to\_string(vessel\_config[\textcolor{stringliteral}{"{}vessel\_id"{}}].get\_int64());}
\DoxyCodeLine{195                 std::string name = \textcolor{stringliteral}{"{}V"{}} + vessel\_id\_string;}
\DoxyCodeLine{196                 T R = vessel\_values[\textcolor{stringliteral}{"{}R\_poiseuille"{}}];}
\DoxyCodeLine{197                 T C = get\_default(vessel\_values, \textcolor{stringliteral}{"{}C"{}}, 0.0);}
\DoxyCodeLine{198                 T L = get\_default(vessel\_values, \textcolor{stringliteral}{"{}L"{}}, 0.0);}
\DoxyCodeLine{199                 T stenosis\_coefficient = get\_default(vessel\_values, \textcolor{stringliteral}{"{}stenosis\_coefficient"{}}, 0.0);}
\DoxyCodeLine{200                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel}{MODEL::BloodVessel<T>}}(R = R, C = C, L = L, stenosis\_coefficient = stenosis\_coefficient, name = name)));}
\DoxyCodeLine{201                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created vessel "{}} << name);}
\DoxyCodeLine{202 }
\DoxyCodeLine{203                 \textcolor{keywordflow}{if} (has\_key(vessel\_config, \textcolor{stringliteral}{"{}boundary\_conditions"{}}) == \textcolor{keyword}{true})}
\DoxyCodeLine{204                 \{}
\DoxyCodeLine{205                     simdjson::dom::element vessel\_bcs = vessel\_config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}];}
\DoxyCodeLine{206                     \textcolor{keywordflow}{if} (has\_key(vessel\_bcs, \textcolor{stringliteral}{"{}inlet"{}}))}
\DoxyCodeLine{207                     \{}
\DoxyCodeLine{208                         std::string bc\_name = \textcolor{stringliteral}{"{}BC"{}} + vessel\_id\_string + \textcolor{stringliteral}{"{}\_inlet"{}};}
\DoxyCodeLine{209                         std::string bc\_handle = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_bcs[\textcolor{stringliteral}{"{}inlet"{}}]);}
\DoxyCodeLine{210                         \textcolor{keywordflow}{for} (simdjson::dom::element bc\_config : config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}])}
\DoxyCodeLine{211                         \{}
\DoxyCodeLine{212                             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}]) == bc\_handle)}
\DoxyCodeLine{213                             \{}
\DoxyCodeLine{214                                 simdjson::dom::element bc\_values = bc\_config[\textcolor{stringliteral}{"{}bc\_values"{}}];}
\DoxyCodeLine{215                                 \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}RCR"{}})}
\DoxyCodeLine{216                                 \{}
\DoxyCodeLine{217                                     T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}];}
\DoxyCodeLine{218                                     T C = bc\_values[\textcolor{stringliteral}{"{}C"{}}];}
\DoxyCodeLine{219                                     T Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}];}
\DoxyCodeLine{220                                     T Pd = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{221                                     model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_r_c_r_block_with_distal_pressure}{MODEL::RCRBlockWithDistalPressure<T>}}(Rp = Rp, C = C, Rd = Rd, Pd = Pd, bc\_name)));}
\DoxyCodeLine{222                                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{223                                 \}}
\DoxyCodeLine{224                                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}FLOW"{}})}
\DoxyCodeLine{225                                 \{}
\DoxyCodeLine{226                                     simdjson::dom::element Q\_json = bc\_values[\textcolor{stringliteral}{"{}Q"{}}];}
\DoxyCodeLine{227                                     simdjson::dom::element t\_json = get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{228                                     \textcolor{keyword}{auto} Q = get\_time\_dependent\_parameter(t\_json, Q\_json);}
\DoxyCodeLine{229                                     cardiac\_cycle\_period = Q.cycle\_period;}
\DoxyCodeLine{230                                     model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference}{MODEL::FlowReference<T>}}(Q = Q, bc\_name)));}
\DoxyCodeLine{231                                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{232                                 \}}
\DoxyCodeLine{233                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{234                                 \{}
\DoxyCodeLine{235                                     \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown boundary condition type "{}} + \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]));}
\DoxyCodeLine{236                                 \}}
\DoxyCodeLine{237                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{238                             \}}
\DoxyCodeLine{239                         \}}
\DoxyCodeLine{240                         \textcolor{keyword}{auto} connection = std::make\_tuple(bc\_name, name);}
\DoxyCodeLine{241                         connections.push\_back(connection);}
\DoxyCodeLine{242                         DEBUG\_MSG(\textcolor{stringliteral}{"{}Found connection "{}} << std::get<0>(connection) << \textcolor{stringliteral}{"{}/"{}} << std::get<1>(connection));}
\DoxyCodeLine{243                     \}}
\DoxyCodeLine{244                     \textcolor{keywordflow}{if} (has\_key(vessel\_bcs, \textcolor{stringliteral}{"{}outlet"{}}) == \textcolor{keyword}{true})}
\DoxyCodeLine{245                     \{}
\DoxyCodeLine{246                         std::string bc\_name = \textcolor{stringliteral}{"{}BC"{}} + vessel\_id\_string + \textcolor{stringliteral}{"{}\_outlet"{}};}
\DoxyCodeLine{247                         std::string bc\_handle = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_bcs[\textcolor{stringliteral}{"{}outlet"{}}]);}
\DoxyCodeLine{248                         \textcolor{keywordflow}{for} (simdjson::dom::element bc\_config : config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}])}
\DoxyCodeLine{249                         \{}
\DoxyCodeLine{250                             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}]) == bc\_handle)}
\DoxyCodeLine{251                             \{}
\DoxyCodeLine{252                                 simdjson::dom::element bc\_values = bc\_config[\textcolor{stringliteral}{"{}bc\_values"{}}];}
\DoxyCodeLine{253                                 \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}RCR"{}})}
\DoxyCodeLine{254                                 \{}
\DoxyCodeLine{255                                     T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}];}
\DoxyCodeLine{256                                     T C = bc\_values[\textcolor{stringliteral}{"{}C"{}}];}
\DoxyCodeLine{257                                     T Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}];}
\DoxyCodeLine{258                                     T Pd = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{259                                     model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_r_c_r_block_with_distal_pressure}{MODEL::RCRBlockWithDistalPressure<T>}}(Rp = Rp, C = C, Rd = Rd, Pd = Pd, bc\_name)));}
\DoxyCodeLine{260                                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{261                                 \}}
\DoxyCodeLine{262                                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}FLOW"{}})}
\DoxyCodeLine{263                                 \{}
\DoxyCodeLine{264                                     simdjson::dom::element Q\_json = bc\_values[\textcolor{stringliteral}{"{}Q"{}}];}
\DoxyCodeLine{265                                     simdjson::dom::element t\_json = get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{266                                     \textcolor{keyword}{auto} Q = get\_time\_dependent\_parameter(t\_json, Q\_json);}
\DoxyCodeLine{267                                     cardiac\_cycle\_period = Q.cycle\_period;}
\DoxyCodeLine{268                                     model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}}.insert(std::make\_pair(bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference}{MODEL::FlowReference<T>}}(Q = Q, bc\_name)));}
\DoxyCodeLine{269                                     DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{270                                 \}}
\DoxyCodeLine{271                                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{272                                 \{}
\DoxyCodeLine{273                                     \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown boundary condition type "{}} + \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]));}
\DoxyCodeLine{274                                 \}}
\DoxyCodeLine{275                                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{276                             \}}
\DoxyCodeLine{277                         \}}
\DoxyCodeLine{278                         \textcolor{keyword}{auto} connection = std::make\_tuple(name, bc\_name);}
\DoxyCodeLine{279                         connections.push\_back(connection);}
\DoxyCodeLine{280                         DEBUG\_MSG(\textcolor{stringliteral}{"{}Found connection "{}} << std::get<0>(connection) << \textcolor{stringliteral}{"{}/"{}} << std::get<1>(connection));}
\DoxyCodeLine{281                     \}}
\DoxyCodeLine{282                 \}}
\DoxyCodeLine{283             \}}
\DoxyCodeLine{284             \textcolor{keywordflow}{else}}
\DoxyCodeLine{285             \{}
\DoxyCodeLine{286                 \textcolor{keywordflow}{throw} std::invalid\_argument(\textcolor{stringliteral}{"{}Unknown vessel type "{}} + \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}vessel\_type"{}}]));}
\DoxyCodeLine{287             \}}
\DoxyCodeLine{288         \}}
\DoxyCodeLine{289 }
\DoxyCodeLine{290         \textcolor{comment}{// Create Connections}}
\DoxyCodeLine{291         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&connection : connections)}
\DoxyCodeLine{292         \{}
\DoxyCodeLine{293             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem1] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}})}
\DoxyCodeLine{294             \{}
\DoxyCodeLine{295                 std::visit([\&](\textcolor{keyword}{auto} \&\&ele1)}
\DoxyCodeLine{296                            \{}
\DoxyCodeLine{297                         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem2] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a99b1375ef649ea5752e25e3d38219b5e}{blocks}})}
\DoxyCodeLine{298                         \{}
\DoxyCodeLine{299                             std::visit([\&](auto \&\&ele2)}
\DoxyCodeLine{300                                     \{if ((ele1.name == std::get<0>(connection)) \&\& (ele2.name == std::get<1>(connection)))\{ model.nodes.push\_back(MODEL::Node(ele1.name + \textcolor{stringliteral}{"{}\_"{}} + ele2.name)); DEBUG\_MSG(\textcolor{stringliteral}{"{}Created node "{}} << model.nodes.back().name); ele1.outlet\_nodes.push\_back(\&model.nodes.back()); ele2.inlet\_nodes.push\_back(\&model.nodes.back()); model.nodes.back().setup\_dofs(model.dofhandler); \} \},}
\DoxyCodeLine{301                                     elem2);}
\DoxyCodeLine{302                         \} \},}
\DoxyCodeLine{303                            elem1);}
\DoxyCodeLine{304             \}}
\DoxyCodeLine{305         \}}
\DoxyCodeLine{306         \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem] : model.blocks)}
\DoxyCodeLine{307         \{}
\DoxyCodeLine{308             std::visit([\&](\textcolor{keyword}{auto} \&\&block)}
\DoxyCodeLine{309                        \{ block.setup\_dofs(model.dofhandler); \},}
\DoxyCodeLine{310                        elem);}
\DoxyCodeLine{311         \}}
\DoxyCodeLine{312         model\_created = \textcolor{keyword}{true};}
\DoxyCodeLine{313         \textcolor{keywordflow}{return} model;}
\DoxyCodeLine{314     \}}
\DoxyCodeLine{315 }
\DoxyCodeLine{316     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{317     \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_num\_time\_steps}}()}
\DoxyCodeLine{318     \{}
\DoxyCodeLine{319         T num\_cycles = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_cardiac\_cycles"{}}];}
\DoxyCodeLine{320         T num\_pts\_per\_cycle = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{321         \textcolor{keywordtype}{int} num\_time\_steps = (num\_pts\_per\_cycle -\/ 1) * num\_cycles + 1;}
\DoxyCodeLine{322         \textcolor{keywordflow}{return} num\_time\_steps;}
\DoxyCodeLine{323     \}}
\DoxyCodeLine{324 }
\DoxyCodeLine{325     \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{326     T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_time\_step\_size}}()}
\DoxyCodeLine{327     \{}
\DoxyCodeLine{328         \textcolor{keywordflow}{if} (model\_created == \textcolor{keyword}{false})}
\DoxyCodeLine{329         \{}
\DoxyCodeLine{330             \textcolor{comment}{// Cardiac cycle period is set at model creation so it has to be performed first}}
\DoxyCodeLine{331             \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Please create model before calculating timstepsize."{}});}
\DoxyCodeLine{332         \}}
\DoxyCodeLine{333         T num\_pts\_per\_cycle = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{334         T time\_step\_size = cardiac\_cycle\_period / (num\_pts\_per\_cycle -\/ 1);}
\DoxyCodeLine{335         \textcolor{keywordflow}{return} time\_step\_size;}
\DoxyCodeLine{336     \}}
\DoxyCodeLine{337 \} \textcolor{comment}{// namespace IO}}
\DoxyCodeLine{338 }
\DoxyCodeLine{339 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}

\end{DoxyCode}
