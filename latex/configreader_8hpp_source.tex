\hypertarget{configreader_8hpp_source}{}\doxysection{configreader.\+hpp}
\label{configreader_8hpp_source}\index{io/configreader.hpp@{io/configreader.hpp}}
\mbox{\hyperlink{configreader_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/**}}
\DoxyCodeLine{2 \textcolor{comment}{ * @file configreader.hpp}}
\DoxyCodeLine{3 \textcolor{comment}{ * @brief IO::ConfigReader source file}}
\DoxyCodeLine{4 \textcolor{comment}{ */}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}../helpers/debug.hpp"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../helpers/startswith.hpp"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}../model/model.hpp"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}simdjson.h"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_i_o}{IO}} \{}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{/**}}
\DoxyCodeLine{20 \textcolor{comment}{ * @brief svZeroDSolver configuration reader.}}
\DoxyCodeLine{21 \textcolor{comment}{ *}}
\DoxyCodeLine{22 \textcolor{comment}{ * @tparam T Scalar type (e.g. `float`, `double`)}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{25 \textcolor{keyword}{class }\mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader}} \{}
\DoxyCodeLine{26  \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{27 \textcolor{comment}{  /**}}
\DoxyCodeLine{28 \textcolor{comment}{   * @brief Construct a new Config Reader object}}
\DoxyCodeLine{29 \textcolor{comment}{   */}}
\DoxyCodeLine{30   \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}();}
\DoxyCodeLine{31 \textcolor{comment}{}}
\DoxyCodeLine{32 \textcolor{comment}{  /**}}
\DoxyCodeLine{33 \textcolor{comment}{   * @brief Construct a new Config Reader object}}
\DoxyCodeLine{34 \textcolor{comment}{   *}}
\DoxyCodeLine{35 \textcolor{comment}{   * Can be constructed either with the path to a json configuration file}}
\DoxyCodeLine{36 \textcolor{comment}{   * or directly with a json encoded string.}}
\DoxyCodeLine{37 \textcolor{comment}{   *}}
\DoxyCodeLine{38 \textcolor{comment}{   * @param specifier Path configuration file or json encoded configuration}}
\DoxyCodeLine{39 \textcolor{comment}{   */}}
\DoxyCodeLine{40   \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}(std::string \&specifier);}
\DoxyCodeLine{41 \textcolor{comment}{}}
\DoxyCodeLine{42 \textcolor{comment}{  /**}}
\DoxyCodeLine{43 \textcolor{comment}{   * @brief Destroy the Config Reader object}}
\DoxyCodeLine{44 \textcolor{comment}{   */}}
\DoxyCodeLine{45   \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{\string~ConfigReader}}();}
\DoxyCodeLine{46 \textcolor{comment}{}}
\DoxyCodeLine{47 \textcolor{comment}{  /**}}
\DoxyCodeLine{48 \textcolor{comment}{   * @brief Create model from configuration file}}
\DoxyCodeLine{49 \textcolor{comment}{   *}}
\DoxyCodeLine{50 \textcolor{comment}{   * @return Model}}
\DoxyCodeLine{51 \textcolor{comment}{   */}}
\DoxyCodeLine{52   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{get\_model}}();}
\DoxyCodeLine{53 \textcolor{comment}{}}
\DoxyCodeLine{54 \textcolor{comment}{  /**}}
\DoxyCodeLine{55 \textcolor{comment}{   * @brief Get number of time steps based on configuration}}
\DoxyCodeLine{56 \textcolor{comment}{   *}}
\DoxyCodeLine{57 \textcolor{comment}{   * @return Number of time steps}}
\DoxyCodeLine{58 \textcolor{comment}{   */}}
\DoxyCodeLine{59   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a30a6649ef956d00d48eb14118d7f4bf4}{get\_num\_time\_steps}}();}
\DoxyCodeLine{60 \textcolor{comment}{}}
\DoxyCodeLine{61 \textcolor{comment}{  /**}}
\DoxyCodeLine{62 \textcolor{comment}{   * @brief Get the time step size based on configuration}}
\DoxyCodeLine{63 \textcolor{comment}{   *}}
\DoxyCodeLine{64 \textcolor{comment}{   * @return Time step size}}
\DoxyCodeLine{65 \textcolor{comment}{   */}}
\DoxyCodeLine{66   T \mbox{\hyperlink{class_i_o_1_1_config_reader_ae63fc5536e55937512435528dcd262bc}{get\_time\_step\_size}}();}
\DoxyCodeLine{67 \textcolor{comment}{}}
\DoxyCodeLine{68 \textcolor{comment}{  /**}}
\DoxyCodeLine{69 \textcolor{comment}{   * @brief Get an integer simulation parameter}}
\DoxyCodeLine{70 \textcolor{comment}{   *}}
\DoxyCodeLine{71 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{72 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{73 \textcolor{comment}{   */}}
\DoxyCodeLine{74   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a684add1b8843da67198e619852bea435}{get\_int\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{75 \textcolor{comment}{}}
\DoxyCodeLine{76 \textcolor{comment}{  /**}}
\DoxyCodeLine{77 \textcolor{comment}{   * @brief Get an integer simulation parameter with default value}}
\DoxyCodeLine{78 \textcolor{comment}{   *}}
\DoxyCodeLine{79 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{80 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{81 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{82 \textcolor{comment}{   */}}
\DoxyCodeLine{83   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a684add1b8843da67198e619852bea435}{get\_int\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{int} def);}
\DoxyCodeLine{84 \textcolor{comment}{}}
\DoxyCodeLine{85 \textcolor{comment}{  /**}}
\DoxyCodeLine{86 \textcolor{comment}{   * @brief Get a scalar simulation parameter}}
\DoxyCodeLine{87 \textcolor{comment}{   *}}
\DoxyCodeLine{88 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{89 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{90 \textcolor{comment}{   */}}
\DoxyCodeLine{91   T \mbox{\hyperlink{class_i_o_1_1_config_reader_abb736d8ea428c43494301da8422cd90f}{get\_scalar\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{92 \textcolor{comment}{}}
\DoxyCodeLine{93 \textcolor{comment}{  /**}}
\DoxyCodeLine{94 \textcolor{comment}{   * @brief Get a scalar simulation parameter with default value}}
\DoxyCodeLine{95 \textcolor{comment}{   *}}
\DoxyCodeLine{96 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{97 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{98 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{99 \textcolor{comment}{   */}}
\DoxyCodeLine{100   T \mbox{\hyperlink{class_i_o_1_1_config_reader_abb736d8ea428c43494301da8422cd90f}{get\_scalar\_simulation\_parameter}}(std::string key, T def);}
\DoxyCodeLine{101 \textcolor{comment}{}}
\DoxyCodeLine{102 \textcolor{comment}{  /**}}
\DoxyCodeLine{103 \textcolor{comment}{   * @brief Get a bool simulation parameter}}
\DoxyCodeLine{104 \textcolor{comment}{   *}}
\DoxyCodeLine{105 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{106 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{107 \textcolor{comment}{   */}}
\DoxyCodeLine{108   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a8a17af470183fa6e3734d26a985211f5}{get\_bool\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{109 \textcolor{comment}{}}
\DoxyCodeLine{110 \textcolor{comment}{  /**}}
\DoxyCodeLine{111 \textcolor{comment}{   * @brief Get a bool simulation parameter with default value}}
\DoxyCodeLine{112 \textcolor{comment}{   *}}
\DoxyCodeLine{113 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{114 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{115 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{116 \textcolor{comment}{   */}}
\DoxyCodeLine{117   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a8a17af470183fa6e3734d26a985211f5}{get\_bool\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{bool} def);}
\DoxyCodeLine{118 \textcolor{comment}{}}
\DoxyCodeLine{119 \textcolor{comment}{  /**}}
\DoxyCodeLine{120 \textcolor{comment}{   * @brief Set final value of cardiac cycle period}}
\DoxyCodeLine{121 \textcolor{comment}{   *}}
\DoxyCodeLine{122 \textcolor{comment}{   */}}
\DoxyCodeLine{123   \textcolor{keywordtype}{void} \mbox{\hyperlink{class_i_o_1_1_config_reader_aa032d89e7d3bb8f2fb64b9f5aaebe1fe}{set\_cardiac\_cycle\_period}}();}
\DoxyCodeLine{124 }
\DoxyCodeLine{125   T \mbox{\hyperlink{class_i_o_1_1_config_reader_a7401fb68b296447b8152636d1d363416}{cardiac\_cycle\_period}} = -\/1.0;  \textcolor{comment}{///< Cardiac cycle period. Negative value indicates this has not been read from config file or from TimeDependent parameter yet}}
\DoxyCodeLine{126 }
\DoxyCodeLine{127  \textcolor{keyword}{private}:}
\DoxyCodeLine{128   \textcolor{keywordtype}{bool} model\_created = \textcolor{keyword}{false};}
\DoxyCodeLine{129   simdjson::dom::parser parser;}
\DoxyCodeLine{130   simdjson::dom::element config;}
\DoxyCodeLine{131   simdjson::dom::element sim\_params;}
\DoxyCodeLine{132   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} has\_key(simdjson::dom::element \&ele, std::string key);}
\DoxyCodeLine{133   \textcolor{keyword}{static} T get\_default(simdjson::dom::element \&ele, std::string key, T def);}
\DoxyCodeLine{134   \textcolor{keyword}{static} \textcolor{keywordtype}{int} get\_default(simdjson::dom::element \&ele, std::string key, \textcolor{keywordtype}{int} def);}
\DoxyCodeLine{135   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{136                           \textcolor{keywordtype}{bool} def);}
\DoxyCodeLine{137   \textcolor{keyword}{static} simdjson::dom::element get\_default(simdjson::dom::element \&ele,}
\DoxyCodeLine{138                                             std::string key,}
\DoxyCodeLine{139                                             simdjson::dom::element def);}
\DoxyCodeLine{140   \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} get\_time\_dependent\_parameter(}
\DoxyCodeLine{141       simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values);}
\DoxyCodeLine{142 \};}
\DoxyCodeLine{143 }
\DoxyCodeLine{144 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{145 \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader<T>::ConfigReader}}(std::string \&specifier) \{}
\DoxyCodeLine{146   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_h_e_l_p_e_r_s_aa60c2dfbfc096834b6cd243f84b9c47b}{HELPERS::startswith}}(specifier, \textcolor{stringliteral}{"{}\{"{}})) \{}
\DoxyCodeLine{147     config = parser.parse(specifier);}
\DoxyCodeLine{148   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{149     config = parser.load(specifier);}
\DoxyCodeLine{150   \}}
\DoxyCodeLine{151   sim\_params = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}];}
\DoxyCodeLine{152 \}}
\DoxyCodeLine{153 }
\DoxyCodeLine{154 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{155 \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{ConfigReader<T>::\string~ConfigReader}}() \{\}}
\DoxyCodeLine{156 }
\DoxyCodeLine{157 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{158 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::has\_key}}(simdjson::dom::element \&ele, std::string key) \{}
\DoxyCodeLine{159   \textcolor{comment}{// Check if config has key by trying}}
\DoxyCodeLine{160   \textcolor{keywordtype}{bool} has\_key = \textcolor{keyword}{true};}
\DoxyCodeLine{161   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{162     simdjson::dom::element tmp = ele.at\_key(key);}
\DoxyCodeLine{163   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{164     has\_key = \textcolor{keyword}{false};}
\DoxyCodeLine{165   \}}
\DoxyCodeLine{166   \textcolor{keywordflow}{return} has\_key;}
\DoxyCodeLine{167 \}}
\DoxyCodeLine{168 }
\DoxyCodeLine{169 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{170 T ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{171                                T def) \{}
\DoxyCodeLine{172   T value = def;}
\DoxyCodeLine{173   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{174     value = ele[key];}
\DoxyCodeLine{175   \}}
\DoxyCodeLine{176   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{177 \}}
\DoxyCodeLine{178 }
\DoxyCodeLine{179 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{180 \textcolor{keywordtype}{int} ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{181                                  \textcolor{keywordtype}{int} def) \{}
\DoxyCodeLine{182   \textcolor{keywordtype}{int} value = def;}
\DoxyCodeLine{183   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{184     value = ele[key].get\_int64();}
\DoxyCodeLine{185   \}}
\DoxyCodeLine{186   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{187 \}}
\DoxyCodeLine{188 }
\DoxyCodeLine{189 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{190 \textcolor{keywordtype}{bool} ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{191                                   \textcolor{keywordtype}{bool} def) \{}
\DoxyCodeLine{192   \textcolor{keywordtype}{bool} value = def;}
\DoxyCodeLine{193   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{194     value = ele[key];}
\DoxyCodeLine{195   \}}
\DoxyCodeLine{196   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{197 \}}
\DoxyCodeLine{198 }
\DoxyCodeLine{199 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{200 simdjson::dom::element ConfigReader<T>::get\_default(}
\DoxyCodeLine{201     simdjson::dom::element \&ele, std::string key, simdjson::dom::element def) \{}
\DoxyCodeLine{202   simdjson::dom::element value = def;}
\DoxyCodeLine{203   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{204     value = ele[key];}
\DoxyCodeLine{205   \}}
\DoxyCodeLine{206   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{207 \}}
\DoxyCodeLine{208 }
\DoxyCodeLine{209 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{210 \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} ConfigReader<T>::get\_time\_dependent\_parameter(}
\DoxyCodeLine{211     simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values) \{}
\DoxyCodeLine{212   std::vector<T> times;}
\DoxyCodeLine{213   std::vector<T> values;}
\DoxyCodeLine{214   \textcolor{keywordflow}{if} (json\_values.is\_double()) \{}
\DoxyCodeLine{215     times.push\_back(0.0);}
\DoxyCodeLine{216     values.push\_back(json\_values);}
\DoxyCodeLine{217   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{218     \textcolor{keywordtype}{int} len = simdjson::dom::array(json\_times).size();}
\DoxyCodeLine{219     times.reserve(len);}
\DoxyCodeLine{220     values.reserve(len);}
\DoxyCodeLine{221     \textcolor{keywordflow}{for} (T time : json\_times) \{}
\DoxyCodeLine{222       times.push\_back(time);}
\DoxyCodeLine{223     \}}
\DoxyCodeLine{224     \textcolor{keywordflow}{for} (T value : json\_values) \{}
\DoxyCodeLine{225       values.push\_back(value);}
\DoxyCodeLine{226     \}}
\DoxyCodeLine{227   \}}
\DoxyCodeLine{228   \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} param(times, values);}
\DoxyCodeLine{229   \textcolor{keywordflow}{if} (param.isconstant == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{230     \textcolor{keywordflow}{if} ((cardiac\_cycle\_period > 0.0) \&\& (param.cycle\_period != cardiac\_cycle\_period)) \{}
\DoxyCodeLine{231       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{232           \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in TimeDependentParameter"{}});}
\DoxyCodeLine{233     \}}
\DoxyCodeLine{234     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{235       cardiac\_cycle\_period = param.cycle\_period;}
\DoxyCodeLine{236     \}}
\DoxyCodeLine{237   \}}
\DoxyCodeLine{238   \textcolor{keywordflow}{return} param;}
\DoxyCodeLine{239 \}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{242 \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{ConfigReader<T>::get\_model}}() \{}
\DoxyCodeLine{243   \textcolor{comment}{// Create blog mapping}}
\DoxyCodeLine{244   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} model;}
\DoxyCodeLine{245 }
\DoxyCodeLine{246   \textcolor{comment}{// Create list to store block connections while generating blocks}}
\DoxyCodeLine{247   std::vector<std::tuple<std::string, std::string>> connections;}
\DoxyCodeLine{248 }
\DoxyCodeLine{249   \textcolor{comment}{// Create list to store outlets that are connected to closed loop model}}
\DoxyCodeLine{250   std::vector<std::string> closed\_loop\_RCRbcs;}
\DoxyCodeLine{251   std::vector<std::string> closed\_loop\_coronarybcs;}
\DoxyCodeLine{252 }
\DoxyCodeLine{253   \textcolor{comment}{// Create junctions}}
\DoxyCodeLine{254   \textcolor{keywordflow}{for} (simdjson::dom::element junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}]) \{}
\DoxyCodeLine{255     \textcolor{keywordflow}{if} ((\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) ==}
\DoxyCodeLine{256          \textcolor{stringliteral}{"{}NORMAL\_JUNCTION"{}}) ||}
\DoxyCodeLine{257         (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) ==}
\DoxyCodeLine{258          \textcolor{stringliteral}{"{}internal\_junction"{}})) \{}
\DoxyCodeLine{259       \textcolor{comment}{// Create the junction and add to blocks}}
\DoxyCodeLine{260       std::string junction\_name =}
\DoxyCodeLine{261           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_name"{}}]);}
\DoxyCodeLine{262       model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(junction\_name)\});}
\DoxyCodeLine{263 }
\DoxyCodeLine{264       \textcolor{comment}{// Check for connections to inlet and outlet vessels and append to}}
\DoxyCodeLine{265       \textcolor{comment}{// connections list}}
\DoxyCodeLine{266       \textcolor{keywordflow}{for} (simdjson::dom::element inlet\_vessel :}
\DoxyCodeLine{267            junction\_config[\textcolor{stringliteral}{"{}inlet\_vessels"{}}]) \{}
\DoxyCodeLine{268         connections.push\_back(}
\DoxyCodeLine{269             \{\textcolor{stringliteral}{"{}V"{}} + std::to\_string(inlet\_vessel.get\_int64()), junction\_name\});}
\DoxyCodeLine{270       \}}
\DoxyCodeLine{271       \textcolor{keywordflow}{for} (simdjson::dom::element outlet\_vessel :}
\DoxyCodeLine{272            junction\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}]) \{}
\DoxyCodeLine{273         connections.push\_back(}
\DoxyCodeLine{274             \{junction\_name, \textcolor{stringliteral}{"{}V"{}} + std::to\_string(outlet\_vessel.get\_int64())\});}
\DoxyCodeLine{275       \}}
\DoxyCodeLine{276     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{277       \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{278           \textcolor{stringliteral}{"{}Unknown junction type "{}} +}
\DoxyCodeLine{279           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]));}
\DoxyCodeLine{280     \}}
\DoxyCodeLine{281   \}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283   \textcolor{comment}{// Create vessels}}
\DoxyCodeLine{284   std::list<std::string> bc\_locations = \{\textcolor{stringliteral}{"{}inlet"{}}, \textcolor{stringliteral}{"{}outlet"{}}\};}
\DoxyCodeLine{285   \textcolor{keywordflow}{for} (simdjson::dom::element vessel\_config : config[\textcolor{stringliteral}{"{}vessels"{}}]) \{}
\DoxyCodeLine{286     simdjson::dom::element vessel\_values =}
\DoxyCodeLine{287         vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_values"{}}];}
\DoxyCodeLine{288     std::string vessel\_id\_string =}
\DoxyCodeLine{289         std::to\_string(vessel\_config[\textcolor{stringliteral}{"{}vessel\_id"{}}].get\_int64());}
\DoxyCodeLine{290     std::string vessel\_name = \textcolor{stringliteral}{"{}V"{}} + vessel\_id\_string;}
\DoxyCodeLine{291     \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_type"{}}]) ==}
\DoxyCodeLine{292         \textcolor{stringliteral}{"{}BloodVessel"{}}) \{}
\DoxyCodeLine{293       T R = vessel\_values[\textcolor{stringliteral}{"{}R\_poiseuille"{}}],}
\DoxyCodeLine{294         C = get\_default(vessel\_values, \textcolor{stringliteral}{"{}C"{}}, 0.0);}
\DoxyCodeLine{295       T L = get\_default(vessel\_values, \textcolor{stringliteral}{"{}L"{}}, 0.0),}
\DoxyCodeLine{296         stenosis\_coefficient =}
\DoxyCodeLine{297             get\_default(vessel\_values, \textcolor{stringliteral}{"{}stenosis\_coefficient"{}}, 0.0);}
\DoxyCodeLine{298       model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{299           \{vessel\_name,}
\DoxyCodeLine{300            \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel}{MODEL::BloodVessel<T>}}(R = R, C = C, L = L,}
\DoxyCodeLine{301                                  stenosis\_coefficient = stenosis\_coefficient,}
\DoxyCodeLine{302                                  vessel\_name)\});}
\DoxyCodeLine{303     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{304       \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{305           \textcolor{stringliteral}{"{}Unknown vessel type "{}} +}
\DoxyCodeLine{306           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}vessel\_type"{}}]));}
\DoxyCodeLine{307     \}}
\DoxyCodeLine{308 }
\DoxyCodeLine{309     \textcolor{comment}{// Create boundary conditions of blood vessel}}
\DoxyCodeLine{310     \textcolor{keywordflow}{if} (has\_key(vessel\_config, \textcolor{stringliteral}{"{}boundary\_conditions"{}}) == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{311       simdjson::dom::element vessel\_bcs = vessel\_config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}];}
\DoxyCodeLine{312       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} loc : bc\_locations) \{}
\DoxyCodeLine{313         \textcolor{comment}{// Check for BC blocks at inlet or outlet}}
\DoxyCodeLine{314         \textcolor{keywordflow}{if} (has\_key(vessel\_bcs, loc)) \{}
\DoxyCodeLine{315           std::string bc\_name = \textcolor{stringliteral}{"{}BC"{}} + vessel\_id\_string + \textcolor{stringliteral}{"{}\_"{}} + loc;}
\DoxyCodeLine{316           std::string bc\_handle = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_bcs[loc]);}
\DoxyCodeLine{317           \textcolor{keywordflow}{for} (simdjson::dom::element bc\_config :}
\DoxyCodeLine{318                config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}]) \{}
\DoxyCodeLine{319             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}]) == bc\_handle) \{}
\DoxyCodeLine{320               simdjson::dom::element bc\_values = bc\_config[\textcolor{stringliteral}{"{}bc\_values"{}}];}
\DoxyCodeLine{321               \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}RCR"{}}) \{}
\DoxyCodeLine{322                 T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}],}
\DoxyCodeLine{323                   Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}], Pd = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{324                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{325                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_windkessel_b_c}{MODEL::WindkesselBC<T>}}(Rp = Rp, C = C, Rd = Rd,}
\DoxyCodeLine{326                                                      Pd = Pd, bc\_name)\});}
\DoxyCodeLine{327                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{328               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}ClosedLoopRCR"{}}) \{}
\DoxyCodeLine{329                 T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}],}
\DoxyCodeLine{330                   Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}];}
\DoxyCodeLine{331                 \textcolor{keywordtype}{bool} closed\_loop\_outlet = bc\_values[\textcolor{stringliteral}{"{}closed\_loop\_outlet"{}}];}
\DoxyCodeLine{332                 \textcolor{keywordflow}{if} (closed\_loop\_outlet == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{333                   closed\_loop\_RCRbcs.push\_back(bc\_name);}
\DoxyCodeLine{334                 \}}
\DoxyCodeLine{335                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{336                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_r_c_r_b_c}{MODEL::ClosedLoopRCRBC<T>}}(Rp = Rp, C = C, Rd = Rd,}
\DoxyCodeLine{337                                                      closed\_loop\_outlet = closed\_loop\_outlet, bc\_name)\});}
\DoxyCodeLine{338                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{339               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{340                          \textcolor{stringliteral}{"{}FLOW"{}}) \{}
\DoxyCodeLine{341                 simdjson::dom::element Q\_json = bc\_values[\textcolor{stringliteral}{"{}Q"{}}],}
\DoxyCodeLine{342                                        t\_json = get\_default(}
\DoxyCodeLine{343                                            bc\_values, \textcolor{stringliteral}{"{}t"{}},}
\DoxyCodeLine{344                                            simdjson::dom::element());}
\DoxyCodeLine{345                 \textcolor{keyword}{auto} Q = get\_time\_dependent\_parameter(t\_json, Q\_json);}
\DoxyCodeLine{346                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{347                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference_b_c}{MODEL::FlowReferenceBC<T>}}(Q = Q, bc\_name)\});}
\DoxyCodeLine{348                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{349               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{350                          \textcolor{stringliteral}{"{}RESISTANCE"{}}) \{}
\DoxyCodeLine{351                 simdjson::dom::element R\_json = bc\_values[\textcolor{stringliteral}{"{}R"{}}],}
\DoxyCodeLine{352                                        Pd\_json = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{353                 simdjson::dom::element t\_json =}
\DoxyCodeLine{354                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{355                 \textcolor{keyword}{auto} R = get\_time\_dependent\_parameter(t\_json, R\_json);}
\DoxyCodeLine{356                 \textcolor{keyword}{auto} Pd = get\_time\_dependent\_parameter(t\_json, Pd\_json);}
\DoxyCodeLine{357                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{358                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistance_b_c}{MODEL::ResistanceBC<T>}}(R = R, Pd = Pd, bc\_name)\});}
\DoxyCodeLine{359                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{360               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{361                          \textcolor{stringliteral}{"{}PRESSURE"{}}) \{}
\DoxyCodeLine{362                 simdjson::dom::element P\_json = bc\_values[\textcolor{stringliteral}{"{}P"{}}];}
\DoxyCodeLine{363                 simdjson::dom::element t\_json =}
\DoxyCodeLine{364                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{365                 \textcolor{keyword}{auto} P = get\_time\_dependent\_parameter(t\_json, P\_json);}
\DoxyCodeLine{366               \textcolor{comment}{//Commented out below lines because they are already being done in get\_time\_dependent\_parameter()}}
\DoxyCodeLine{367               \textcolor{comment}{//if (P.isconstant == false) \{ }}
\DoxyCodeLine{368               \textcolor{comment}{//  cardiac\_cycle\_period = P.cycle\_period;}}
\DoxyCodeLine{369               \textcolor{comment}{//\}}}
\DoxyCodeLine{370                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{371                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_pressure_reference_b_c}{MODEL::PressureReferenceBC<T>}}(P = P, bc\_name)\});}
\DoxyCodeLine{372                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{373               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{374                          \textcolor{stringliteral}{"{}CORONARY"{}}) \{}
\DoxyCodeLine{375                 T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra1"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ra2"{}}],}
\DoxyCodeLine{376                   Rv = bc\_values[\textcolor{stringliteral}{"{}Rv1"{}}], Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}],}
\DoxyCodeLine{377                   Cim = bc\_values[\textcolor{stringliteral}{"{}Cc"{}}];}
\DoxyCodeLine{378                 simdjson::dom::element Pim\_json = bc\_values[\textcolor{stringliteral}{"{}Pim"{}}],}
\DoxyCodeLine{379                                        Pv\_json = bc\_values[\textcolor{stringliteral}{"{}P\_v"{}}];}
\DoxyCodeLine{380                 simdjson::dom::element t\_json =}
\DoxyCodeLine{381                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{382                 \textcolor{keyword}{auto} Pim = get\_time\_dependent\_parameter(t\_json, Pim\_json);}
\DoxyCodeLine{383                 \textcolor{keyword}{auto} Pv = get\_time\_dependent\_parameter(t\_json, Pv\_json);}
\DoxyCodeLine{384                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{385                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_open_loop_coronary_b_c}{MODEL::OpenLoopCoronaryBC<T>}}(}
\DoxyCodeLine{386                                   Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca,}
\DoxyCodeLine{387                                   Cim = Cim, Pim = Pim, Pv = Pv, bc\_name)\});}
\DoxyCodeLine{388                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{389               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{390                          \textcolor{stringliteral}{"{}ClosedLoopCoronary"{}}) \{}
\DoxyCodeLine{391                 T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ram"{}}],}
\DoxyCodeLine{392                   Rv = bc\_values[\textcolor{stringliteral}{"{}Rv"{}}], Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}],}
\DoxyCodeLine{393                   Cim = bc\_values[\textcolor{stringliteral}{"{}Cim"{}}];}
\DoxyCodeLine{394                   std:\textcolor{keywordtype}{string} side = bc\_values[\textcolor{stringliteral}{"{}side"{}}];}
\DoxyCodeLine{395                   closed\_loop\_coronarybcs.push\_back(bc\_name);}
\DoxyCodeLine{396                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{397                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_coronary_b_c}{MODEL::ClosedLoopCoronaryBC<T>}}(}
\DoxyCodeLine{398                                   Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca,}
\DoxyCodeLine{399                                   Cim = Cim, side = side, bc\_name)\});}
\DoxyCodeLine{400                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{401               \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{402                 \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{403                     \textcolor{stringliteral}{"{}Unknown boundary condition type "{}} +}
\DoxyCodeLine{404                     \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]));}
\DoxyCodeLine{405               \}}
\DoxyCodeLine{406               \textcolor{keywordflow}{break};}
\DoxyCodeLine{407             \}}
\DoxyCodeLine{408           \}}
\DoxyCodeLine{409           \textcolor{keywordflow}{if} (loc == \textcolor{stringliteral}{"{}inlet"{}}) \{}
\DoxyCodeLine{410             connections.push\_back(\{bc\_name, vessel\_name\});}
\DoxyCodeLine{411           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{412             connections.push\_back(\{vessel\_name, bc\_name\});}
\DoxyCodeLine{413           \}}
\DoxyCodeLine{414         \}}
\DoxyCodeLine{415       \}}
\DoxyCodeLine{416     \}}
\DoxyCodeLine{417   \}}
\DoxyCodeLine{418 }
\DoxyCodeLine{419   \textcolor{comment}{// Create closed-\/loop blocks}}
\DoxyCodeLine{420   \textcolor{keywordflow}{if} (has\_key(config, \textcolor{stringliteral}{"{}closed\_loop\_blocks"{}}) == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{421     \textcolor{keywordtype}{int} closed\_loop\_index = -\/1;}
\DoxyCodeLine{422     \textcolor{keywordflow}{for} (simdjson::dom::element closed\_loop\_config : config[\textcolor{stringliteral}{"{}closed\_loop\_blocks"{}}]) \{}
\DoxyCodeLine{423       closed\_loop\_index++;}
\DoxyCodeLine{424       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(closed\_loop\_config[\textcolor{stringliteral}{"{}closed\_loop\_type"{}}]) ==}
\DoxyCodeLine{425            \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}}) \{ }
\DoxyCodeLine{426         \textcolor{keywordflow}{if} (model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a8cfe88359cb868d581a547d43efea173}{heartpulmonary\_block\_present}} == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{427           \textcolor{comment}{// Create the closed\_loop and add to blocks}}
\DoxyCodeLine{428           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a8cfe88359cb868d581a547d43efea173}{heartpulmonary\_block\_present}} = \textcolor{keyword}{true};}
\DoxyCodeLine{429           std::string heartpulmonary\_name = \textcolor{stringliteral}{"{}CLH"{}} + std::to\_string(closed\_loop\_index);}
\DoxyCodeLine{430           simdjson::dom::element heart\_params = closed\_loop\_config[\textcolor{stringliteral}{"{}parameters"{}}];}
\DoxyCodeLine{431           \textcolor{keywordtype}{int} num\_heart\_params = 0;}
\DoxyCodeLine{432           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_value : heart\_params) \{}
\DoxyCodeLine{433             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_value.key) != \textcolor{stringliteral}{"{}\_comment\_"{}}) \{}
\DoxyCodeLine{434               num\_heart\_params++;}
\DoxyCodeLine{435             \}}
\DoxyCodeLine{436           \}}
\DoxyCodeLine{437           \textcolor{keywordflow}{if} (num\_heart\_params == 27) \{}
\DoxyCodeLine{438             model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heartpulmonary\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_heart_pulmonary}{MODEL::ClosedLoopHeartPulmonary}}(heart\_params, heartpulmonary\_name)\});}
\DoxyCodeLine{439           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{440             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{441                 \textcolor{stringliteral}{"{}Error. Heart block must have 27 parameters."{}});}
\DoxyCodeLine{442           \}}
\DoxyCodeLine{443           \textcolor{comment}{// Count number of junctions in config file (is there a better way)}}
\DoxyCodeLine{444           \textcolor{keywordtype}{int} num\_junctions = 0;}
\DoxyCodeLine{445           \textcolor{keywordflow}{for} (simdjson::dom::element junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}]) \{}
\DoxyCodeLine{446             num\_junctions++;}
\DoxyCodeLine{447           \}}
\DoxyCodeLine{448           \textcolor{comment}{// Junction at inlet to heart}}
\DoxyCodeLine{449           std::string heart\_inlet\_junction\_name = \textcolor{stringliteral}{"{}J\_"{}} + std::to\_string(num\_junctions);}
\DoxyCodeLine{450           connections.push\_back(\{heart\_inlet\_junction\_name, heartpulmonary\_name\});}
\DoxyCodeLine{451           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heart\_inlet\_junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(heart\_inlet\_junction\_name)\});}
\DoxyCodeLine{452           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_inlet\_elem : closed\_loop\_RCRbcs) \{}
\DoxyCodeLine{453             connections.push\_back(\{heart\_inlet\_elem, heart\_inlet\_junction\_name\});}
\DoxyCodeLine{454           \}}
\DoxyCodeLine{455           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_inlet\_elem : closed\_loop\_coronarybcs) \{}
\DoxyCodeLine{456             connections.push\_back(\{heart\_inlet\_elem, heart\_inlet\_junction\_name\});}
\DoxyCodeLine{457           \}}
\DoxyCodeLine{458           \textcolor{comment}{// Junction at outlet from heart}}
\DoxyCodeLine{459           std::string heart\_outlet\_junction\_name = \textcolor{stringliteral}{"{}J\_"{}} + std::to\_string(num\_junctions+1);}
\DoxyCodeLine{460           connections.push\_back(\{heartpulmonary\_name, heart\_outlet\_junction\_name\});}
\DoxyCodeLine{461           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heart\_outlet\_junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(heart\_outlet\_junction\_name)\});}
\DoxyCodeLine{462           \textcolor{keywordflow}{for} (simdjson::dom::element heart\_outlet\_vessel : closed\_loop\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}]) \{}
\DoxyCodeLine{463             connections.push\_back(\{heart\_outlet\_junction\_name,\textcolor{stringliteral}{"{}V"{}} + std::to\_string(heart\_outlet\_vessel.get\_int64())\});}
\DoxyCodeLine{464           \}}
\DoxyCodeLine{465         \}}
\DoxyCodeLine{466         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{467           \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Error. Only one ClosedLoopHeartAndPulmonary can be included."{}});}
\DoxyCodeLine{468         \}}
\DoxyCodeLine{469       \}}
\DoxyCodeLine{470     \}}
\DoxyCodeLine{471   \}}
\DoxyCodeLine{472     }
\DoxyCodeLine{473   \textcolor{comment}{// Create Connections}}
\DoxyCodeLine{474   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&connection : connections) \{}
\DoxyCodeLine{475     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem1] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}) \{}
\DoxyCodeLine{476       std::visit(}
\DoxyCodeLine{477           [\&](\textcolor{keyword}{auto} \&\&ele1) \{}
\DoxyCodeLine{478             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem2] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}) \{}
\DoxyCodeLine{479               std::visit(}
\DoxyCodeLine{480                   [\&](auto \&\&ele2) \{}
\DoxyCodeLine{481                     if ((ele1.name == std::get<0>(connection)) \&\&}
\DoxyCodeLine{482                         (ele2.name == std::get<1>(connection))) \{}
\DoxyCodeLine{483                       model.nodes.push\_back(}
\DoxyCodeLine{484                           MODEL::Node(ele1.name + \textcolor{stringliteral}{"{}\_"{}} + ele2.name));}
\DoxyCodeLine{485                       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created node "{}} << model.nodes.back().name);}
\DoxyCodeLine{486                       ele1.outlet\_nodes.push\_back(\&model.nodes.back());}
\DoxyCodeLine{487                       ele2.inlet\_nodes.push\_back(\&model.nodes.back());}
\DoxyCodeLine{488                       model.nodes.back().setup\_dofs(model.dofhandler);}
\DoxyCodeLine{489                     \}}
\DoxyCodeLine{490                   \},}
\DoxyCodeLine{491                   elem2);}
\DoxyCodeLine{492             \}}
\DoxyCodeLine{493           \},}
\DoxyCodeLine{494           elem1);}
\DoxyCodeLine{495     \}}
\DoxyCodeLine{496   \}}
\DoxyCodeLine{497   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem] : model.blocks) \{}
\DoxyCodeLine{498     std::visit([\&](\textcolor{keyword}{auto} \&\&block) \{ block.setup\_dofs(model.dofhandler); \}, elem);}
\DoxyCodeLine{499   \}}
\DoxyCodeLine{500   }
\DoxyCodeLine{501   \textcolor{comment}{// Set cardiac cycle period after all blocks have been created}}
\DoxyCodeLine{502   this-\/>set\_cardiac\_cycle\_period()}
\DoxyCodeLine{503 }
\DoxyCodeLine{504   \textcolor{comment}{// Update closed loop blocks:}}
\DoxyCodeLine{505   \textcolor{comment}{// 1. Cardiac cycle perdiod in heart block}}
\DoxyCodeLine{506   \textcolor{comment}{// 2. Coronary block params that depend on heart block DOFs}}
\DoxyCodeLine{507   if (model.heartpulmonary\_block\_present == true) \{}
\DoxyCodeLine{508     \textcolor{keyword}{auto} heart\_block = model.blocks[heartpulomonary\_name];}
\DoxyCodeLine{509     heart\_block.cardiac\_cycle\_period = cardiac\_cycle\_period;}
\DoxyCodeLine{510     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} coronarybc\_name : closed\_loop\_coronarybcs) \{}
\DoxyCodeLine{511       \textcolor{keyword}{auto} coronary\_bc = model.blocks[coronarybc\_name];}
\DoxyCodeLine{512       coronary\_bc.update\_coronary\_parameters(heart\_block);}
\DoxyCodeLine{513     \}}
\DoxyCodeLine{514   \}}
\DoxyCodeLine{515 }
\DoxyCodeLine{516   model\_created = \textcolor{keyword}{true};}
\DoxyCodeLine{517   \textcolor{keywordflow}{return} model;}
\DoxyCodeLine{518 \}}
\DoxyCodeLine{519 }
\DoxyCodeLine{520 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{521 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_num\_time\_steps}}() \{}
\DoxyCodeLine{522   T num\_cycles = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_cardiac\_cycles"{}}];}
\DoxyCodeLine{523   T num\_pts\_per\_cycle =}
\DoxyCodeLine{524       config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{525   \textcolor{keywordtype}{int} num\_time\_steps = (num\_pts\_per\_cycle -\/ 1) * num\_cycles + 1;}
\DoxyCodeLine{526   \textcolor{keywordflow}{return} num\_time\_steps;}
\DoxyCodeLine{527 \}}
\DoxyCodeLine{528 }
\DoxyCodeLine{529 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{530 \textcolor{keywordtype}{void} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::set\_cardiac\_cycle\_period}}() \{}
\DoxyCodeLine{531   \textcolor{comment}{// Either read from config file and checked against values read from TimeDependentParameters}}
\DoxyCodeLine{532   \textcolor{comment}{// Or set to default value of 1.0 if it hasn't been set anywhere else during model setup}}
\DoxyCodeLine{533   \textcolor{keywordflow}{if} (has\_key(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}],\textcolor{stringliteral}{"{}cardiac\_cycle\_period"{}})) \{}
\DoxyCodeLine{534     T cardiac\_cycle\_period\_config = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}cardiac\_cycle\_period"{}}];}
\DoxyCodeLine{535     \textcolor{keywordflow}{if} ((cardiac\_cycle\_period > 0.0) \&\& (cardiac\_cycle\_period\_config != cardiac\_cycle\_period)) \{}
\DoxyCodeLine{536       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{537           \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in config file and TimeDependentParameter"{}});}
\DoxyCodeLine{538     \}}
\DoxyCodeLine{539     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{540       \textcolor{comment}{// If it hasn't been set by any other TimeDependentParameter yet (i.e. cardiac\_cycle\_period<0) or is the same as current value}}
\DoxyCodeLine{541       cardiac\_cycle\_period = cardiac\_cycle\_period\_config }
\DoxyCodeLine{542     \}}
\DoxyCodeLine{543   \}}
\DoxyCodeLine{544   \textcolor{keywordflow}{else} \{ }
\DoxyCodeLine{545     \textcolor{keywordflow}{if} (cardiac\_cycle\_period < 0.0) \{}
\DoxyCodeLine{546       cardiac\_cycle\_period = 1.0; \textcolor{comment}{// If cardiac\_cycle\_period has not been set anywhere yet, set as default value of 1.0}}
\DoxyCodeLine{547     \}}
\DoxyCodeLine{548   \}}
\DoxyCodeLine{549 \}}
\DoxyCodeLine{550 }
\DoxyCodeLine{551 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{552 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_time\_step\_size}}() \{}
\DoxyCodeLine{553   \textcolor{keywordflow}{if} (model\_created == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{554     \textcolor{comment}{// Cardiac cycle period is set at model creation so it has to be performed}}
\DoxyCodeLine{555     \textcolor{comment}{// first}}
\DoxyCodeLine{556     \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{557         \textcolor{stringliteral}{"{}Please create model before calculating timstepsize."{}});}
\DoxyCodeLine{558   \}}
\DoxyCodeLine{559   T num\_pts\_per\_cycle =}
\DoxyCodeLine{560       config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{561   T time\_step\_size = cardiac\_cycle\_period / (num\_pts\_per\_cycle -\/ 1);}
\DoxyCodeLine{562   \textcolor{keywordflow}{return} time\_step\_size;}
\DoxyCodeLine{563 \}}
\DoxyCodeLine{564 }
\DoxyCodeLine{565 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{566 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_int\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{567   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{568 \}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{571 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_int\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{int} def) \{}
\DoxyCodeLine{572   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{573 \}}
\DoxyCodeLine{574 }
\DoxyCodeLine{575 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{576 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_scalar\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{577   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{578 \}}
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{581 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_scalar\_simulation\_parameter}}(std::string key, T def) \{}
\DoxyCodeLine{582   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{583 \}}
\DoxyCodeLine{584 }
\DoxyCodeLine{585 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{586 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_bool\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{587   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{588 \}}
\DoxyCodeLine{589 }
\DoxyCodeLine{590 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{591 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_bool\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{bool} def) \{}
\DoxyCodeLine{592   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{593 \}}
\DoxyCodeLine{594 }
\DoxyCodeLine{595 \}  \textcolor{comment}{// namespace IO}}
\DoxyCodeLine{596 }
\DoxyCodeLine{597 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}

\end{DoxyCode}
