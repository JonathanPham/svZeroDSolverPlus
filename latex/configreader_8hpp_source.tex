\hypertarget{configreader_8hpp_source}{}\doxysection{configreader.\+hpp}
\label{configreader_8hpp_source}\index{io/configreader.hpp@{io/configreader.hpp}}
\mbox{\hyperlink{configreader_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/**}}
\DoxyCodeLine{2 \textcolor{comment}{ * @file configreader.hpp}}
\DoxyCodeLine{3 \textcolor{comment}{ * @brief IO::ConfigReader source file}}
\DoxyCodeLine{4 \textcolor{comment}{ */}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#ifndef SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#define SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}
\DoxyCodeLine{7 }
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <list>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <stdexcept>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{11 }
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include "{}../helpers/debug.hpp"{}}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include "{}../helpers/startswith.hpp"{}}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include "{}../model/model.hpp"{}}}
\DoxyCodeLine{15 \textcolor{preprocessor}{\#include "{}simdjson.h"{}}}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespace_i_o}{IO}} \{}
\DoxyCodeLine{18 \textcolor{comment}{}}
\DoxyCodeLine{19 \textcolor{comment}{/**}}
\DoxyCodeLine{20 \textcolor{comment}{ * @brief svZeroDSolver configuration reader.}}
\DoxyCodeLine{21 \textcolor{comment}{ *}}
\DoxyCodeLine{22 \textcolor{comment}{ * @tparam T Scalar type (e.g. `float`, `double`)}}
\DoxyCodeLine{23 \textcolor{comment}{ */}}
\DoxyCodeLine{24 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{25 \textcolor{keyword}{class }\mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader}} \{}
\DoxyCodeLine{26  \textcolor{keyword}{public}:\textcolor{comment}{}}
\DoxyCodeLine{27 \textcolor{comment}{  /**}}
\DoxyCodeLine{28 \textcolor{comment}{   * @brief Construct a new Config Reader object}}
\DoxyCodeLine{29 \textcolor{comment}{   */}}
\DoxyCodeLine{30   \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}();}
\DoxyCodeLine{31 \textcolor{comment}{}}
\DoxyCodeLine{32 \textcolor{comment}{  /**}}
\DoxyCodeLine{33 \textcolor{comment}{   * @brief Construct a new Config Reader object}}
\DoxyCodeLine{34 \textcolor{comment}{   *}}
\DoxyCodeLine{35 \textcolor{comment}{   * Can be constructed either with the path to a json configuration file}}
\DoxyCodeLine{36 \textcolor{comment}{   * or directly with a json encoded string.}}
\DoxyCodeLine{37 \textcolor{comment}{   *}}
\DoxyCodeLine{38 \textcolor{comment}{   * @param specifier Path configuration file or json encoded configuration}}
\DoxyCodeLine{39 \textcolor{comment}{   */}}
\DoxyCodeLine{40   \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader}}(std::string \&specifier);}
\DoxyCodeLine{41 \textcolor{comment}{}}
\DoxyCodeLine{42 \textcolor{comment}{  /**}}
\DoxyCodeLine{43 \textcolor{comment}{   * @brief Destroy the Config Reader object}}
\DoxyCodeLine{44 \textcolor{comment}{   */}}
\DoxyCodeLine{45   \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{\string~ConfigReader}}();}
\DoxyCodeLine{46 \textcolor{comment}{}}
\DoxyCodeLine{47 \textcolor{comment}{  /**}}
\DoxyCodeLine{48 \textcolor{comment}{   * @brief Create model from configuration file}}
\DoxyCodeLine{49 \textcolor{comment}{   *}}
\DoxyCodeLine{50 \textcolor{comment}{   * @return Model}}
\DoxyCodeLine{51 \textcolor{comment}{   */}}
\DoxyCodeLine{52   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{get\_model}}();}
\DoxyCodeLine{53 \textcolor{comment}{}}
\DoxyCodeLine{54 \textcolor{comment}{  /**}}
\DoxyCodeLine{55 \textcolor{comment}{   * @brief Get number of time steps based on configuration}}
\DoxyCodeLine{56 \textcolor{comment}{   *}}
\DoxyCodeLine{57 \textcolor{comment}{   * @return Number of time steps}}
\DoxyCodeLine{58 \textcolor{comment}{   */}}
\DoxyCodeLine{59   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a30a6649ef956d00d48eb14118d7f4bf4}{get\_num\_time\_steps}}();}
\DoxyCodeLine{60 \textcolor{comment}{}}
\DoxyCodeLine{61 \textcolor{comment}{  /**}}
\DoxyCodeLine{62 \textcolor{comment}{   * @brief Get the time step size based on configuration}}
\DoxyCodeLine{63 \textcolor{comment}{   *}}
\DoxyCodeLine{64 \textcolor{comment}{   * @return Time step size}}
\DoxyCodeLine{65 \textcolor{comment}{   */}}
\DoxyCodeLine{66   T \mbox{\hyperlink{class_i_o_1_1_config_reader_ae63fc5536e55937512435528dcd262bc}{get\_time\_step\_size}}();}
\DoxyCodeLine{67 \textcolor{comment}{}}
\DoxyCodeLine{68 \textcolor{comment}{  /**}}
\DoxyCodeLine{69 \textcolor{comment}{   * @brief Get an integer simulation parameter}}
\DoxyCodeLine{70 \textcolor{comment}{   *}}
\DoxyCodeLine{71 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{72 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{73 \textcolor{comment}{   */}}
\DoxyCodeLine{74   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a684add1b8843da67198e619852bea435}{get\_int\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{75 \textcolor{comment}{}}
\DoxyCodeLine{76 \textcolor{comment}{  /**}}
\DoxyCodeLine{77 \textcolor{comment}{   * @brief Get an integer simulation parameter with default value}}
\DoxyCodeLine{78 \textcolor{comment}{   *}}
\DoxyCodeLine{79 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{80 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{81 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{82 \textcolor{comment}{   */}}
\DoxyCodeLine{83   \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader_a684add1b8843da67198e619852bea435}{get\_int\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{int} def);}
\DoxyCodeLine{84 \textcolor{comment}{}}
\DoxyCodeLine{85 \textcolor{comment}{  /**}}
\DoxyCodeLine{86 \textcolor{comment}{   * @brief Get a scalar simulation parameter}}
\DoxyCodeLine{87 \textcolor{comment}{   *}}
\DoxyCodeLine{88 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{89 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{90 \textcolor{comment}{   */}}
\DoxyCodeLine{91   T \mbox{\hyperlink{class_i_o_1_1_config_reader_abb736d8ea428c43494301da8422cd90f}{get\_scalar\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{92 \textcolor{comment}{}}
\DoxyCodeLine{93 \textcolor{comment}{  /**}}
\DoxyCodeLine{94 \textcolor{comment}{   * @brief Get a scalar simulation parameter with default value}}
\DoxyCodeLine{95 \textcolor{comment}{   *}}
\DoxyCodeLine{96 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{97 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{98 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{99 \textcolor{comment}{   */}}
\DoxyCodeLine{100   T \mbox{\hyperlink{class_i_o_1_1_config_reader_abb736d8ea428c43494301da8422cd90f}{get\_scalar\_simulation\_parameter}}(std::string key, T def);}
\DoxyCodeLine{101 \textcolor{comment}{}}
\DoxyCodeLine{102 \textcolor{comment}{  /**}}
\DoxyCodeLine{103 \textcolor{comment}{   * @brief Get a bool simulation parameter}}
\DoxyCodeLine{104 \textcolor{comment}{   *}}
\DoxyCodeLine{105 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{106 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{107 \textcolor{comment}{   */}}
\DoxyCodeLine{108   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a8a17af470183fa6e3734d26a985211f5}{get\_bool\_simulation\_parameter}}(std::string key);}
\DoxyCodeLine{109 \textcolor{comment}{}}
\DoxyCodeLine{110 \textcolor{comment}{  /**}}
\DoxyCodeLine{111 \textcolor{comment}{   * @brief Get a bool simulation parameter with default value}}
\DoxyCodeLine{112 \textcolor{comment}{   *}}
\DoxyCodeLine{113 \textcolor{comment}{   * @param key The key of the simulation parameter}}
\DoxyCodeLine{114 \textcolor{comment}{   * @param def Default value if key not in simulation parameters}}
\DoxyCodeLine{115 \textcolor{comment}{   * @return Value of the simulation parameter}}
\DoxyCodeLine{116 \textcolor{comment}{   */}}
\DoxyCodeLine{117   \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader_a8a17af470183fa6e3734d26a985211f5}{get\_bool\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{bool} def);}
\DoxyCodeLine{118 }
\DoxyCodeLine{119   T \mbox{\hyperlink{class_i_o_1_1_config_reader_a7401fb68b296447b8152636d1d363416}{cardiac\_cycle\_period}} = -\/1.0;  \textcolor{comment}{///< Cardiac cycle period. Negative value indicates this has not been read from config file or from TimeDependent parameter yet}}
\DoxyCodeLine{120 }
\DoxyCodeLine{121  \textcolor{keyword}{private}:}
\DoxyCodeLine{122   \textcolor{keywordtype}{bool} model\_created = \textcolor{keyword}{false};}
\DoxyCodeLine{123   simdjson::dom::parser parser;}
\DoxyCodeLine{124   simdjson::dom::element config;}
\DoxyCodeLine{125   simdjson::dom::element sim\_params;}
\DoxyCodeLine{126   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} has\_key(simdjson::dom::element \&ele, std::string key);}
\DoxyCodeLine{127   \textcolor{keyword}{static} T get\_default(simdjson::dom::element \&ele, std::string key, T def);}
\DoxyCodeLine{128   \textcolor{keyword}{static} \textcolor{keywordtype}{int} get\_default(simdjson::dom::element \&ele, std::string key, \textcolor{keywordtype}{int} def);}
\DoxyCodeLine{129   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{130                           \textcolor{keywordtype}{bool} def);}
\DoxyCodeLine{131   \textcolor{keyword}{static} simdjson::dom::element get\_default(simdjson::dom::element \&ele,}
\DoxyCodeLine{132                                             std::string key,}
\DoxyCodeLine{133                                             simdjson::dom::element def);}
\DoxyCodeLine{134   \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} get\_time\_dependent\_parameter(}
\DoxyCodeLine{135       simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values);}
\DoxyCodeLine{136 \};}
\DoxyCodeLine{137 }
\DoxyCodeLine{138 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{139 \mbox{\hyperlink{class_i_o_1_1_config_reader_a62ff5f79acc744f70ef8e33723aedbb1}{ConfigReader<T>::ConfigReader}}(std::string \&specifier) \{}
\DoxyCodeLine{140   \textcolor{keywordflow}{if} (\mbox{\hyperlink{namespace_h_e_l_p_e_r_s_aa60c2dfbfc096834b6cd243f84b9c47b}{HELPERS::startswith}}(specifier, \textcolor{stringliteral}{"{}\{"{}})) \{}
\DoxyCodeLine{141     config = parser.parse(specifier);}
\DoxyCodeLine{142   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{143     config = parser.load(specifier);}
\DoxyCodeLine{144   \}}
\DoxyCodeLine{145   sim\_params = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}];}
\DoxyCodeLine{146 \}}
\DoxyCodeLine{147 }
\DoxyCodeLine{148 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{149 \mbox{\hyperlink{class_i_o_1_1_config_reader_a848b6ada6d5b8683418403e90b69b796}{ConfigReader<T>::\string~ConfigReader}}() \{\}}
\DoxyCodeLine{150 }
\DoxyCodeLine{151 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{152 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::has\_key}}(simdjson::dom::element \&ele, std::string key) \{}
\DoxyCodeLine{153   \textcolor{comment}{// Check if config has key by trying}}
\DoxyCodeLine{154   \textcolor{keywordtype}{bool} has\_key = \textcolor{keyword}{true};}
\DoxyCodeLine{155   \textcolor{keywordflow}{try} \{}
\DoxyCodeLine{156     simdjson::dom::element tmp = ele.at\_key(key);}
\DoxyCodeLine{157   \} \textcolor{keywordflow}{catch} (simdjson::simdjson\_error) \{}
\DoxyCodeLine{158     has\_key = \textcolor{keyword}{false};}
\DoxyCodeLine{159   \}}
\DoxyCodeLine{160   \textcolor{keywordflow}{return} has\_key;}
\DoxyCodeLine{161 \}}
\DoxyCodeLine{162 }
\DoxyCodeLine{163 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{164 T ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{165                                T def) \{}
\DoxyCodeLine{166   T value = def;}
\DoxyCodeLine{167   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{168     value = ele[key];}
\DoxyCodeLine{169   \}}
\DoxyCodeLine{170   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{171 \}}
\DoxyCodeLine{172 }
\DoxyCodeLine{173 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{174 \textcolor{keywordtype}{int} ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{175                                  \textcolor{keywordtype}{int} def) \{}
\DoxyCodeLine{176   \textcolor{keywordtype}{int} value = def;}
\DoxyCodeLine{177   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{178     value = ele[key].get\_int64();}
\DoxyCodeLine{179   \}}
\DoxyCodeLine{180   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{181 \}}
\DoxyCodeLine{182 }
\DoxyCodeLine{183 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{184 \textcolor{keywordtype}{bool} ConfigReader<T>::get\_default(simdjson::dom::element \&ele, std::string key,}
\DoxyCodeLine{185                                   \textcolor{keywordtype}{bool} def) \{}
\DoxyCodeLine{186   \textcolor{keywordtype}{bool} value = def;}
\DoxyCodeLine{187   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{188     value = ele[key];}
\DoxyCodeLine{189   \}}
\DoxyCodeLine{190   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{191 \}}
\DoxyCodeLine{192 }
\DoxyCodeLine{193 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{194 simdjson::dom::element ConfigReader<T>::get\_default(}
\DoxyCodeLine{195     simdjson::dom::element \&ele, std::string key, simdjson::dom::element def) \{}
\DoxyCodeLine{196   simdjson::dom::element value = def;}
\DoxyCodeLine{197   \textcolor{keywordflow}{if} (has\_key(ele, key)) \{}
\DoxyCodeLine{198     value = ele[key];}
\DoxyCodeLine{199   \}}
\DoxyCodeLine{200   \textcolor{keywordflow}{return} value;}
\DoxyCodeLine{201 \}}
\DoxyCodeLine{202 }
\DoxyCodeLine{203 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{204 \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} ConfigReader<T>::get\_time\_dependent\_parameter(}
\DoxyCodeLine{205     simdjson::dom::element \&json\_times, simdjson::dom::element \&json\_values) \{}
\DoxyCodeLine{206   std::vector<T> times;}
\DoxyCodeLine{207   std::vector<T> values;}
\DoxyCodeLine{208   \textcolor{keywordflow}{if} (json\_values.is\_double()) \{}
\DoxyCodeLine{209     times.push\_back(0.0);}
\DoxyCodeLine{210     values.push\_back(json\_values);}
\DoxyCodeLine{211   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{212     \textcolor{keywordtype}{int} len = simdjson::dom::array(json\_times).size();}
\DoxyCodeLine{213     times.reserve(len);}
\DoxyCodeLine{214     values.reserve(len);}
\DoxyCodeLine{215     \textcolor{keywordflow}{for} (T time : json\_times) \{}
\DoxyCodeLine{216       times.push\_back(time);}
\DoxyCodeLine{217     \}}
\DoxyCodeLine{218     \textcolor{keywordflow}{for} (T value : json\_values) \{}
\DoxyCodeLine{219       values.push\_back(value);}
\DoxyCodeLine{220     \}}
\DoxyCodeLine{221   \}}
\DoxyCodeLine{222   \mbox{\hyperlink{class_m_o_d_e_l_1_1_time_dependent_parameter}{MODEL::TimeDependentParameter<T>}} param(times, values);}
\DoxyCodeLine{223   \textcolor{keywordflow}{if} (param.isconstant == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{224     \textcolor{keywordflow}{if} ((cardiac\_cycle\_period > 0.0) \&\& (param.cycle\_period != cardiac\_cycle\_period)) \{}
\DoxyCodeLine{225       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{226           \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in TimeDependentParameter"{}});}
\DoxyCodeLine{227     \}}
\DoxyCodeLine{228     \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{229       cardiac\_cycle\_period = param.cycle\_period;}
\DoxyCodeLine{230     \}}
\DoxyCodeLine{231   \}}
\DoxyCodeLine{232   \textcolor{keywordflow}{return} param;}
\DoxyCodeLine{233 \}}
\DoxyCodeLine{234 }
\DoxyCodeLine{235 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{236 \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} \mbox{\hyperlink{class_i_o_1_1_config_reader_acbfe926ecbf754503071f8c62a64b3be}{ConfigReader<T>::get\_model}}() \{}
\DoxyCodeLine{237   \textcolor{comment}{// Create blog mapping}}
\DoxyCodeLine{238   \mbox{\hyperlink{class_m_o_d_e_l_1_1_model}{MODEL::Model<T>}} model;}
\DoxyCodeLine{239 }
\DoxyCodeLine{240   \textcolor{comment}{// Create list to store block connections while generating blocks}}
\DoxyCodeLine{241   std::vector<std::tuple<std::string, std::string>> connections;}
\DoxyCodeLine{242 }
\DoxyCodeLine{243   \textcolor{comment}{// Create list to store outlets that are connected to closed loop model}}
\DoxyCodeLine{244   std::vector<std::string> closed\_loop\_RCRbcs;}
\DoxyCodeLine{245   std::vector<std::string> closed\_loop\_coronarybcs;}
\DoxyCodeLine{246 }
\DoxyCodeLine{247   \textcolor{comment}{// Create junctions}}
\DoxyCodeLine{248   \textcolor{keywordflow}{for} (simdjson::dom::element junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}]) \{}
\DoxyCodeLine{249     \textcolor{keywordflow}{if} ((\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) ==}
\DoxyCodeLine{250          \textcolor{stringliteral}{"{}NORMAL\_JUNCTION"{}}) ||}
\DoxyCodeLine{251         (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]) ==}
\DoxyCodeLine{252          \textcolor{stringliteral}{"{}internal\_junction"{}})) \{}
\DoxyCodeLine{253       \textcolor{comment}{// Create the junction and add to blocks}}
\DoxyCodeLine{254       std::string junction\_name =}
\DoxyCodeLine{255           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_name"{}}]);}
\DoxyCodeLine{256       model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(junction\_name)\});}
\DoxyCodeLine{257 }
\DoxyCodeLine{258       \textcolor{comment}{// Check for connections to inlet and outlet vessels and append to}}
\DoxyCodeLine{259       \textcolor{comment}{// connections list}}
\DoxyCodeLine{260       \textcolor{keywordflow}{for} (simdjson::dom::element inlet\_vessel :}
\DoxyCodeLine{261            junction\_config[\textcolor{stringliteral}{"{}inlet\_vessels"{}}]) \{}
\DoxyCodeLine{262         connections.push\_back(}
\DoxyCodeLine{263             \{\textcolor{stringliteral}{"{}V"{}} + std::to\_string(inlet\_vessel.get\_int64()), junction\_name\});}
\DoxyCodeLine{264       \}}
\DoxyCodeLine{265       \textcolor{keywordflow}{for} (simdjson::dom::element outlet\_vessel :}
\DoxyCodeLine{266            junction\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}]) \{}
\DoxyCodeLine{267         connections.push\_back(}
\DoxyCodeLine{268             \{junction\_name, \textcolor{stringliteral}{"{}V"{}} + std::to\_string(outlet\_vessel.get\_int64())\});}
\DoxyCodeLine{269       \}}
\DoxyCodeLine{270     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{271       \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{272           \textcolor{stringliteral}{"{}Unknown junction type "{}} +}
\DoxyCodeLine{273           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(junction\_config[\textcolor{stringliteral}{"{}junction\_type"{}}]));}
\DoxyCodeLine{274     \}}
\DoxyCodeLine{275   \}}
\DoxyCodeLine{276 }
\DoxyCodeLine{277   \textcolor{comment}{// Create vessels}}
\DoxyCodeLine{278   std::list<std::string> bc\_locations = \{\textcolor{stringliteral}{"{}inlet"{}}, \textcolor{stringliteral}{"{}outlet"{}}\};}
\DoxyCodeLine{279   \textcolor{keywordflow}{for} (simdjson::dom::element vessel\_config : config[\textcolor{stringliteral}{"{}vessels"{}}]) \{}
\DoxyCodeLine{280     simdjson::dom::element vessel\_values =}
\DoxyCodeLine{281         vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_values"{}}];}
\DoxyCodeLine{282     std::string vessel\_id\_string =}
\DoxyCodeLine{283         std::to\_string(vessel\_config[\textcolor{stringliteral}{"{}vessel\_id"{}}].get\_int64());}
\DoxyCodeLine{284     std::string vessel\_name = \textcolor{stringliteral}{"{}V"{}} + vessel\_id\_string;}
\DoxyCodeLine{285     \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}zero\_d\_element\_type"{}}]) ==}
\DoxyCodeLine{286         \textcolor{stringliteral}{"{}BloodVessel"{}}) \{}
\DoxyCodeLine{287       T R = vessel\_values[\textcolor{stringliteral}{"{}R\_poiseuille"{}}],}
\DoxyCodeLine{288         C = get\_default(vessel\_values, \textcolor{stringliteral}{"{}C"{}}, 0.0);}
\DoxyCodeLine{289       T L = get\_default(vessel\_values, \textcolor{stringliteral}{"{}L"{}}, 0.0),}
\DoxyCodeLine{290         stenosis\_coefficient =}
\DoxyCodeLine{291             get\_default(vessel\_values, \textcolor{stringliteral}{"{}stenosis\_coefficient"{}}, 0.0);}
\DoxyCodeLine{292       model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{293           \{vessel\_name,}
\DoxyCodeLine{294            \mbox{\hyperlink{class_m_o_d_e_l_1_1_blood_vessel}{MODEL::BloodVessel<T>}}(R = R, C = C, L = L,}
\DoxyCodeLine{295                                  stenosis\_coefficient = stenosis\_coefficient,}
\DoxyCodeLine{296                                  vessel\_name)\});}
\DoxyCodeLine{297     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{298       \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{299           \textcolor{stringliteral}{"{}Unknown vessel type "{}} +}
\DoxyCodeLine{300           \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_config[\textcolor{stringliteral}{"{}vessel\_type"{}}]));}
\DoxyCodeLine{301     \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303     \textcolor{comment}{// Create boundary conditions of blood vessel}}
\DoxyCodeLine{304     \textcolor{keywordflow}{if} (has\_key(vessel\_config, \textcolor{stringliteral}{"{}boundary\_conditions"{}}) == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{305       simdjson::dom::element vessel\_bcs = vessel\_config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}];}
\DoxyCodeLine{306       \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} loc : bc\_locations) \{}
\DoxyCodeLine{307         \textcolor{comment}{// Check for BC blocks at inlet or outlet}}
\DoxyCodeLine{308         \textcolor{keywordflow}{if} (has\_key(vessel\_bcs, loc)) \{}
\DoxyCodeLine{309           std::string bc\_name = \textcolor{stringliteral}{"{}BC"{}} + vessel\_id\_string + \textcolor{stringliteral}{"{}\_"{}} + loc;}
\DoxyCodeLine{310           std::string bc\_handle = \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(vessel\_bcs[loc]);}
\DoxyCodeLine{311           \textcolor{keywordflow}{for} (simdjson::dom::element bc\_config :}
\DoxyCodeLine{312                config[\textcolor{stringliteral}{"{}boundary\_conditions"{}}]) \{}
\DoxyCodeLine{313             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_name"{}}]) == bc\_handle) \{}
\DoxyCodeLine{314               simdjson::dom::element bc\_values = bc\_config[\textcolor{stringliteral}{"{}bc\_values"{}}];}
\DoxyCodeLine{315               \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}RCR"{}}) \{}
\DoxyCodeLine{316                 T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}],}
\DoxyCodeLine{317                   Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}], Pd = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{318                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{319                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_windkessel_b_c}{MODEL::WindkesselBC<T>}}(Rp = Rp, C = C, Rd = Rd,}
\DoxyCodeLine{320                                                      Pd = Pd, bc\_name)\});}
\DoxyCodeLine{321                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{322               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) == \textcolor{stringliteral}{"{}ClosedLoopRCR"{}}) \{}
\DoxyCodeLine{323                 T Rp = bc\_values[\textcolor{stringliteral}{"{}Rp"{}}], C = bc\_values[\textcolor{stringliteral}{"{}C"{}}],}
\DoxyCodeLine{324                   Rd = bc\_values[\textcolor{stringliteral}{"{}Rd"{}}];}
\DoxyCodeLine{325                 \textcolor{keywordtype}{bool} closed\_loop\_outlet = bc\_values[\textcolor{stringliteral}{"{}closed\_loop\_outlet"{}}];}
\DoxyCodeLine{326                 \textcolor{keywordflow}{if} (closed\_loop\_outlet == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{327                   closed\_loop\_RCRbcs.push\_back(bc\_name);}
\DoxyCodeLine{328                 \}}
\DoxyCodeLine{329                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{330                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_r_c_r_b_c}{MODEL::ClosedLoopRCRBC<T>}}(Rp = Rp, C = C, Rd = Rd,}
\DoxyCodeLine{331                                                      closed\_loop\_outlet = closed\_loop\_outlet, bc\_name)\});}
\DoxyCodeLine{332                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{333               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{334                          \textcolor{stringliteral}{"{}FLOW"{}}) \{}
\DoxyCodeLine{335                 simdjson::dom::element Q\_json = bc\_values[\textcolor{stringliteral}{"{}Q"{}}],}
\DoxyCodeLine{336                                        t\_json = get\_default(}
\DoxyCodeLine{337                                            bc\_values, \textcolor{stringliteral}{"{}t"{}},}
\DoxyCodeLine{338                                            simdjson::dom::element());}
\DoxyCodeLine{339                 \textcolor{keyword}{auto} Q = get\_time\_dependent\_parameter(t\_json, Q\_json);}
\DoxyCodeLine{340                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{341                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_flow_reference_b_c}{MODEL::FlowReferenceBC<T>}}(Q = Q, bc\_name)\});}
\DoxyCodeLine{342                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{343               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{344                          \textcolor{stringliteral}{"{}RESISTANCE"{}}) \{}
\DoxyCodeLine{345                 simdjson::dom::element R\_json = bc\_values[\textcolor{stringliteral}{"{}R"{}}],}
\DoxyCodeLine{346                                        Pd\_json = bc\_values[\textcolor{stringliteral}{"{}Pd"{}}];}
\DoxyCodeLine{347                 simdjson::dom::element t\_json =}
\DoxyCodeLine{348                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{349                 \textcolor{keyword}{auto} R = get\_time\_dependent\_parameter(t\_json, R\_json);}
\DoxyCodeLine{350                 \textcolor{keyword}{auto} Pd = get\_time\_dependent\_parameter(t\_json, Pd\_json);}
\DoxyCodeLine{351                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{352                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_resistance_b_c}{MODEL::ResistanceBC<T>}}(R = R, Pd = Pd, bc\_name)\});}
\DoxyCodeLine{353                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{354               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{355                          \textcolor{stringliteral}{"{}PRESSURE"{}}) \{}
\DoxyCodeLine{356                 simdjson::dom::element P\_json = bc\_values[\textcolor{stringliteral}{"{}P"{}}];}
\DoxyCodeLine{357                 simdjson::dom::element t\_json =}
\DoxyCodeLine{358                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{359                 \textcolor{keyword}{auto} P = get\_time\_dependent\_parameter(t\_json, P\_json);}
\DoxyCodeLine{360               \textcolor{comment}{//Commented out below lines because they are already being done in get\_time\_dependent\_parameter()}}
\DoxyCodeLine{361               \textcolor{comment}{//if (P.isconstant == false) \{ }}
\DoxyCodeLine{362               \textcolor{comment}{//  cardiac\_cycle\_period = P.cycle\_period;}}
\DoxyCodeLine{363               \textcolor{comment}{//\}}}
\DoxyCodeLine{364                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{365                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_pressure_reference_b_c}{MODEL::PressureReferenceBC<T>}}(P = P, bc\_name)\});}
\DoxyCodeLine{366                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{367               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{368                          \textcolor{stringliteral}{"{}CORONARY"{}}) \{}
\DoxyCodeLine{369                 T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra1"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ra2"{}}],}
\DoxyCodeLine{370                   Rv = bc\_values[\textcolor{stringliteral}{"{}Rv1"{}}], Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}],}
\DoxyCodeLine{371                   Cim = bc\_values[\textcolor{stringliteral}{"{}Cc"{}}];}
\DoxyCodeLine{372                 simdjson::dom::element Pim\_json = bc\_values[\textcolor{stringliteral}{"{}Pim"{}}],}
\DoxyCodeLine{373                                        Pv\_json = bc\_values[\textcolor{stringliteral}{"{}P\_v"{}}];}
\DoxyCodeLine{374                 simdjson::dom::element t\_json =}
\DoxyCodeLine{375                     get\_default(bc\_values, \textcolor{stringliteral}{"{}t"{}}, simdjson::dom::element());}
\DoxyCodeLine{376                 \textcolor{keyword}{auto} Pim = get\_time\_dependent\_parameter(t\_json, Pim\_json);}
\DoxyCodeLine{377                 \textcolor{keyword}{auto} Pv = get\_time\_dependent\_parameter(t\_json, Pv\_json);}
\DoxyCodeLine{378                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{379                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_open_loop_coronary_b_c}{MODEL::OpenLoopCoronaryBC<T>}}(}
\DoxyCodeLine{380                                   Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca,}
\DoxyCodeLine{381                                   Cim = Cim, Pim = Pim, Pv = Pv, bc\_name)\});}
\DoxyCodeLine{382                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{383               \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]) ==}
\DoxyCodeLine{384                          \textcolor{stringliteral}{"{}ClosedLoopCoronary"{}}) \{}
\DoxyCodeLine{385                 T Ra = bc\_values[\textcolor{stringliteral}{"{}Ra"{}}], Ram = bc\_values[\textcolor{stringliteral}{"{}Ram"{}}],}
\DoxyCodeLine{386                   Rv = bc\_values[\textcolor{stringliteral}{"{}Rv"{}}], Ca = bc\_values[\textcolor{stringliteral}{"{}Ca"{}}],}
\DoxyCodeLine{387                   Cim = bc\_values[\textcolor{stringliteral}{"{}Cim"{}}];}
\DoxyCodeLine{388                   std:\textcolor{keywordtype}{string} side = bc\_values[\textcolor{stringliteral}{"{}side"{}}];}
\DoxyCodeLine{389                   closed\_loop\_coronarybcs.push\_back(bc\_name);}
\DoxyCodeLine{390                 model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(}
\DoxyCodeLine{391                     \{bc\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_coronary_b_c}{MODEL::ClosedLoopCoronaryBC<T>}}(}
\DoxyCodeLine{392                                   Ra = Ra, Ram = Ram, Rv = Rv, Ca = Ca,}
\DoxyCodeLine{393                                   Cim = Cim, side = side, bc\_name)\});}
\DoxyCodeLine{394                 DEBUG\_MSG(\textcolor{stringliteral}{"{}Created boundary condition "{}} << bc\_name);}
\DoxyCodeLine{395               \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{396                 \textcolor{keywordflow}{throw} std::invalid\_argument(}
\DoxyCodeLine{397                     \textcolor{stringliteral}{"{}Unknown boundary condition type "{}} +}
\DoxyCodeLine{398                     \textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(bc\_config[\textcolor{stringliteral}{"{}bc\_type"{}}]));}
\DoxyCodeLine{399               \}}
\DoxyCodeLine{400               \textcolor{keywordflow}{break};}
\DoxyCodeLine{401             \}}
\DoxyCodeLine{402           \}}
\DoxyCodeLine{403           \textcolor{keywordflow}{if} (loc == \textcolor{stringliteral}{"{}inlet"{}}) \{}
\DoxyCodeLine{404             connections.push\_back(\{bc\_name, vessel\_name\});}
\DoxyCodeLine{405           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{406             connections.push\_back(\{vessel\_name, bc\_name\});}
\DoxyCodeLine{407           \}}
\DoxyCodeLine{408         \}}
\DoxyCodeLine{409       \}}
\DoxyCodeLine{410     \}}
\DoxyCodeLine{411   \}}
\DoxyCodeLine{412 }
\DoxyCodeLine{413   \textcolor{comment}{// Create closed-\/loop blocks}}
\DoxyCodeLine{414   \textcolor{keywordflow}{if} (has\_key(config, \textcolor{stringliteral}{"{}closed\_loop\_blocks"{}}) == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{415     \textcolor{keywordtype}{int} closed\_loop\_index = -\/1;}
\DoxyCodeLine{416     \textcolor{keywordflow}{for} (simdjson::dom::element closed\_loop\_config : config[\textcolor{stringliteral}{"{}closed\_loop\_blocks"{}}]) \{}
\DoxyCodeLine{417       closed\_loop\_index++;}
\DoxyCodeLine{418       \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(closed\_loop\_config[\textcolor{stringliteral}{"{}closed\_loop\_type"{}}]) ==}
\DoxyCodeLine{419            \textcolor{stringliteral}{"{}ClosedLoopHeartAndPulmonary"{}}) \{ }
\DoxyCodeLine{420         \textcolor{keywordflow}{if} (model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a8cfe88359cb868d581a547d43efea173}{heartpulmonary\_block\_present}} == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{421           \textcolor{comment}{// Create the closed\_loop and add to blocks}}
\DoxyCodeLine{422           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a8cfe88359cb868d581a547d43efea173}{heartpulmonary\_block\_present}} = \textcolor{keyword}{true};}
\DoxyCodeLine{423           std::string heartpulmonary\_name = \textcolor{stringliteral}{"{}CLH"{}} + std::to\_string(closed\_loop\_index);}
\DoxyCodeLine{424           simdjson::dom::element heart\_params = closed\_loop\_config[\textcolor{stringliteral}{"{}parameters"{}}];}
\DoxyCodeLine{425           \textcolor{keywordtype}{int} num\_heart\_params = 0;}
\DoxyCodeLine{426           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_value : heart\_params) \{}
\DoxyCodeLine{427             \textcolor{keywordflow}{if} (\textcolor{keyword}{static\_cast<}std::string\textcolor{keyword}{>}(heart\_value.key) != \textcolor{stringliteral}{"{}\_comment\_"{}}) \{}
\DoxyCodeLine{428               num\_heart\_params++;}
\DoxyCodeLine{429             \}}
\DoxyCodeLine{430           \}}
\DoxyCodeLine{431           \textcolor{keywordflow}{if} (num\_heart\_params == 27) \{}
\DoxyCodeLine{432             model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heartpulmonary\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_closed_loop_heart_pulmonary}{MODEL::ClosedLoopHeartPulmonary}}(heart\_params, heartpulmonary\_name)\});}
\DoxyCodeLine{433           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{434             \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{435                 \textcolor{stringliteral}{"{}Error. Heart block must have 27 parameters."{}});}
\DoxyCodeLine{436           \}}
\DoxyCodeLine{437           \textcolor{comment}{// Count number of junctions in config file (is there a better way)}}
\DoxyCodeLine{438           \textcolor{keywordtype}{int} num\_junctions = 0;}
\DoxyCodeLine{439           \textcolor{keywordflow}{for} (simdjson::dom::element junction\_config : config[\textcolor{stringliteral}{"{}junctions"{}}]) \{}
\DoxyCodeLine{440             num\_junctions++;}
\DoxyCodeLine{441           \}}
\DoxyCodeLine{442           \textcolor{comment}{// Junction at inlet to heart}}
\DoxyCodeLine{443           std::string heart\_inlet\_junction\_name = \textcolor{stringliteral}{"{}J\_"{}} + std::to\_string(num\_junctions);}
\DoxyCodeLine{444           connections.push\_back(\{heart\_inlet\_junction\_name, heartpulmonary\_name\});}
\DoxyCodeLine{445           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heart\_inlet\_junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(heart\_inlet\_junction\_name)\});}
\DoxyCodeLine{446           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_inlet\_elem : closed\_loop\_RCRbcs) \{}
\DoxyCodeLine{447             connections.push\_back(\{heart\_inlet\_elem, heart\_inlet\_junction\_name\});}
\DoxyCodeLine{448           \}}
\DoxyCodeLine{449           \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} heart\_inlet\_elem : closed\_loop\_coronarybcs) \{}
\DoxyCodeLine{450             connections.push\_back(\{heart\_inlet\_elem, heart\_inlet\_junction\_name\});}
\DoxyCodeLine{451           \}}
\DoxyCodeLine{452           \textcolor{comment}{// Junction at outlet from heart}}
\DoxyCodeLine{453           std::string heart\_outlet\_junction\_name = \textcolor{stringliteral}{"{}J\_"{}} + std::to\_string(num\_junctions+1);}
\DoxyCodeLine{454           connections.push\_back(\{heartpulmonary\_name, heart\_outlet\_junction\_name\});}
\DoxyCodeLine{455           model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}.insert(\{heart\_outlet\_junction\_name, \mbox{\hyperlink{class_m_o_d_e_l_1_1_junction}{MODEL::Junction<T>}}(heart\_outlet\_junction\_name)\});}
\DoxyCodeLine{456           \textcolor{keywordflow}{for} (simdjson::dom::element heart\_outlet\_vessel : closed\_loop\_config[\textcolor{stringliteral}{"{}outlet\_vessels"{}}]) \{}
\DoxyCodeLine{457             connections.push\_back(\{heart\_outlet\_junction\_name,\textcolor{stringliteral}{"{}V"{}} + std::to\_string(heart\_outlet\_vessel.get\_int64())\});}
\DoxyCodeLine{458           \}}
\DoxyCodeLine{459         \}}
\DoxyCodeLine{460         \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{461           \textcolor{keywordflow}{throw} std::runtime\_error(\textcolor{stringliteral}{"{}Error. Only one ClosedLoopHeartAndPulmonary can be included."{}});}
\DoxyCodeLine{462         \}}
\DoxyCodeLine{463       \}}
\DoxyCodeLine{464     \}}
\DoxyCodeLine{465   \}}
\DoxyCodeLine{466     }
\DoxyCodeLine{467   \textcolor{comment}{// Create Connections}}
\DoxyCodeLine{468   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&connection : connections) \{}
\DoxyCodeLine{469     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem1] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}) \{}
\DoxyCodeLine{470       std::visit(}
\DoxyCodeLine{471           [\&](\textcolor{keyword}{auto} \&\&ele1) \{}
\DoxyCodeLine{472             \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem2] : model.\mbox{\hyperlink{class_m_o_d_e_l_1_1_model_a22b59013236fd0fb3ae4fec09b371525}{blocks}}) \{}
\DoxyCodeLine{473               std::visit(}
\DoxyCodeLine{474                   [\&](auto \&\&ele2) \{}
\DoxyCodeLine{475                     if ((ele1.name == std::get<0>(connection)) \&\&}
\DoxyCodeLine{476                         (ele2.name == std::get<1>(connection))) \{}
\DoxyCodeLine{477                       model.nodes.push\_back(}
\DoxyCodeLine{478                           MODEL::Node(ele1.name + \textcolor{stringliteral}{"{}\_"{}} + ele2.name));}
\DoxyCodeLine{479                       DEBUG\_MSG(\textcolor{stringliteral}{"{}Created node "{}} << model.nodes.back().name);}
\DoxyCodeLine{480                       ele1.outlet\_nodes.push\_back(\&model.nodes.back());}
\DoxyCodeLine{481                       ele2.inlet\_nodes.push\_back(\&model.nodes.back());}
\DoxyCodeLine{482                       model.nodes.back().setup\_dofs(model.dofhandler);}
\DoxyCodeLine{483                     \}}
\DoxyCodeLine{484                   \},}
\DoxyCodeLine{485                   elem2);}
\DoxyCodeLine{486             \}}
\DoxyCodeLine{487           \},}
\DoxyCodeLine{488           elem1);}
\DoxyCodeLine{489     \}}
\DoxyCodeLine{490   \}}
\DoxyCodeLine{491   \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&[key, elem] : model.blocks) \{}
\DoxyCodeLine{492     std::visit([\&](\textcolor{keyword}{auto} \&\&block) \{ block.setup\_dofs(model.dofhandler); \}, elem);}
\DoxyCodeLine{493   \}}
\DoxyCodeLine{494   }
\DoxyCodeLine{495   \textcolor{comment}{// Update coronary block params that depend on heart block DOFs}}
\DoxyCodeLine{496   \textcolor{keywordflow}{if} (model.heartpulmonary\_block\_present == \textcolor{keyword}{true}) \{}
\DoxyCodeLine{497     \textcolor{keyword}{auto} heart\_block = model.blocks[heartpulomonary\_name]; }
\DoxyCodeLine{498     \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} coronarybc\_name : closed\_loop\_coronarybcs) \{}
\DoxyCodeLine{499       \textcolor{keyword}{auto} coronary\_bc = model.blocks[coronarybc\_name];}
\DoxyCodeLine{500       coronary\_bc.update\_coronary\_parameters(heart\_block);}
\DoxyCodeLine{501     \}}
\DoxyCodeLine{502   \}}
\DoxyCodeLine{503 }
\DoxyCodeLine{504   model\_created = \textcolor{keyword}{true};}
\DoxyCodeLine{505   \textcolor{keywordflow}{return} model;}
\DoxyCodeLine{506 \}}
\DoxyCodeLine{507 }
\DoxyCodeLine{508 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{509 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_num\_time\_steps}}() \{}
\DoxyCodeLine{510   T num\_cycles = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_cardiac\_cycles"{}}];}
\DoxyCodeLine{511   T num\_pts\_per\_cycle =}
\DoxyCodeLine{512       config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{513   \textcolor{keywordtype}{int} num\_time\_steps = (num\_pts\_per\_cycle -\/ 1) * num\_cycles + 1;}
\DoxyCodeLine{514   \textcolor{keywordflow}{return} num\_time\_steps;}
\DoxyCodeLine{515 \}}
\DoxyCodeLine{516 }
\DoxyCodeLine{517 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{518 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_time\_step\_size}}() \{}
\DoxyCodeLine{519   \textcolor{keywordflow}{if} (model\_created == \textcolor{keyword}{false}) \{}
\DoxyCodeLine{520     \textcolor{comment}{// Cardiac cycle period is set at model creation so it has to be performed}}
\DoxyCodeLine{521     \textcolor{comment}{// first}}
\DoxyCodeLine{522     \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{523         \textcolor{stringliteral}{"{}Please create model before calculating timstepsize."{}});}
\DoxyCodeLine{524   \}}
\DoxyCodeLine{525   T num\_pts\_per\_cycle =}
\DoxyCodeLine{526       config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}number\_of\_time\_pts\_per\_cardiac\_cycle"{}}];}
\DoxyCodeLine{527   }
\DoxyCodeLine{528   \textcolor{comment}{// Set final value of cardiac cycle period}}
\DoxyCodeLine{529   \textcolor{comment}{// Either read from config file and checked against values read from TimeDependentParameters}}
\DoxyCodeLine{530   \textcolor{comment}{// Or set to default value of 1.0 if it hasn't been set anywhere else during model setup}}
\DoxyCodeLine{531   \textcolor{keywordflow}{if} (has\_key(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}],\textcolor{stringliteral}{"{}cardiac\_cycle\_period"{}})) \{}
\DoxyCodeLine{532     T cardiac\_cycle\_period\_config = config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][\textcolor{stringliteral}{"{}cardiac\_cycle\_period"{}}];}
\DoxyCodeLine{533     \textcolor{keywordflow}{if} ((cardiac\_cycle\_period > 0.0) \&\& (cardiac\_cycle\_period\_config != cardiac\_cycle\_period)) \{}
\DoxyCodeLine{534       \textcolor{keywordflow}{throw} std::runtime\_error(}
\DoxyCodeLine{535           \textcolor{stringliteral}{"{}Inconsistent cardiac cycle period defined in config file and TimeDependentParameter"{}});}
\DoxyCodeLine{536     \}}
\DoxyCodeLine{537     \textcolor{keywordflow}{else} \{ \textcolor{comment}{// If it hasn't been set by any other TimeDependentParameter yet (i.e. cardiac\_cycle\_period<0)}}
\DoxyCodeLine{538       cardiac\_cycle\_period = cardiac\_cycle\_period\_config }
\DoxyCodeLine{539     \}}
\DoxyCodeLine{540   \}}
\DoxyCodeLine{541   \textcolor{keywordflow}{else} \{ }
\DoxyCodeLine{542     \textcolor{keywordflow}{if} (cardiac\_cycle\_period < 0.0) \{}
\DoxyCodeLine{543       cardiac\_cycle\_period = 1.0; \textcolor{comment}{// If cardiac\_cycle\_period has not been set anywhere yet, set as default value of 1.0}}
\DoxyCodeLine{544     \}}
\DoxyCodeLine{545   \}}
\DoxyCodeLine{546   T time\_step\_size = cardiac\_cycle\_period / (num\_pts\_per\_cycle -\/ 1);}
\DoxyCodeLine{547   \textcolor{keywordflow}{return} time\_step\_size;}
\DoxyCodeLine{548 \}}
\DoxyCodeLine{549 }
\DoxyCodeLine{550 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{551 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_int\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{552   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{553 \}}
\DoxyCodeLine{554 }
\DoxyCodeLine{555 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{556 \textcolor{keywordtype}{int} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_int\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{int} def) \{}
\DoxyCodeLine{557   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{558 \}}
\DoxyCodeLine{559 }
\DoxyCodeLine{560 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{561 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_scalar\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{562   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{563 \}}
\DoxyCodeLine{564 }
\DoxyCodeLine{565 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{566 T \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_scalar\_simulation\_parameter}}(std::string key, T def) \{}
\DoxyCodeLine{567   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{568 \}}
\DoxyCodeLine{569 }
\DoxyCodeLine{570 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{571 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_bool\_simulation\_parameter}}(std::string key) \{}
\DoxyCodeLine{572   \textcolor{keywordflow}{return} int(config[\textcolor{stringliteral}{"{}simulation\_parameters"{}}][key]);}
\DoxyCodeLine{573 \}}
\DoxyCodeLine{574 }
\DoxyCodeLine{575 \textcolor{keyword}{template} <\textcolor{keyword}{typename} T>}
\DoxyCodeLine{576 \textcolor{keywordtype}{bool} \mbox{\hyperlink{class_i_o_1_1_config_reader}{ConfigReader<T>::get\_bool\_simulation\_parameter}}(std::string key, \textcolor{keywordtype}{bool} def) \{}
\DoxyCodeLine{577   \textcolor{keywordflow}{return} get\_default(sim\_params, key, def);}
\DoxyCodeLine{578 \}}
\DoxyCodeLine{579 }
\DoxyCodeLine{580 \}  \textcolor{comment}{// namespace IO}}
\DoxyCodeLine{581 }
\DoxyCodeLine{582 \textcolor{preprocessor}{\#endif  }\textcolor{comment}{// SVZERODSOLVER\_IO\_CONFIGREADER\_HPP\_}}

\end{DoxyCode}
